!function(e){var t={};function n(a){if(t[a])return t[a].exports;var r=t[a]={i:a,l:!1,exports:{}};return e[a].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(a,r,function(t){return e[t]}.bind(null,r));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=34)}({34:function(e,t,n){"use strict";n.r(t);n(35),n(36),n(37),n(38);async function a(e){if("anima"===window.extensionName&&!r&&window.userData){const e=window.userData&&window.userData.email?window.userData.email:"";e?chrome.runtime.setUninstallURL(`${window.API_PROJECT}/chrome-extension-uninstall?email=${e}`):chrome.runtime.setUninstallURL(window.API_PROJECT+"/chrome-extension-uninstall")}}window.userLogin=!1,window.mainButton="code",window.extensionName=null,window.userData,window.access_token,chrome.runtime.onMessage.addListener((e,t,n)=>("sendApi"==e.api?async function(e,t,n="GET",a,r=!1,o){let s=t&&"projects"===t.baseUrl?window.API_PROJECT:window.API_URL;a&&"localhost"===a.baseUrl&&(s="http://localhost:5007");const i=r?e:`${s}${e}`;t&&t.baseUrl&&delete t.baseUrl;const c={method:n,headers:a,body:t?JSON.stringify(t):null};let l=await fetch(i,c);if(200==l.status){if(a&&a.toText){return await l.text()}return await l.json()}return{error:await l.json()}}(e.url,e.data,e.method,e.header,e.overwriteUrl).then(e=>{n(e)}):"logout"===e.api?(window.userData=null,window.access_token=null,chrome.tabs.getAllInWindow(e=>{e.map(e=>{chrome.tabs.sendMessage(e.id,{message:"logout"},null,()=>{})})})):"removeUserCache"===e.api?(window.userData=null,window.access_token=null):"loadFeatureFlag"===e.api?(window.mainButton=e.mainButton,window.extensionName=e.extensionName,a()):"userLogin"===e.api?(window.userLogin=e.isLogin,a()):"updateUserCache"===e.api&&(window.userData=e.userData,window.access_token=e.access_token,a()),!0)),chrome.runtime.onInstalled.addListener((function(e){chrome.tabs.query({currentWindow:!0},(function(e){const t=chrome.runtime.getManifest().content_scripts[0].js[0];for(let n=0;n<e.length;n++)chrome.tabs.executeScript(e[n].id,{file:t},e=>{})}))}));let r=!0;r&&chrome.tabs.onUpdated.addListener((e,t,n)=>{"complete"===t.status&&n.url.includes("figma.com")&&chrome.tabs.executeScript(e,{file:"app/app.bundle.js"},()=>{})})},35:function(e,t){window.API_URL="https://api.animaapp.com",window.API_PROJECT="https://projects.animaapp.com"},36:function(e,t){var n=!1;let a,r=null;chrome.runtime.onMessage.addListener((e,t,s)=>{if("getFigmaDesignFromAnima"===e.api){r=t.tab.id,n=!1,clearTimeout(a),a=setTimeout(()=>{n=!0},36e4),t&&t.tab&&t.tab.id&&o.push(t.tab.id);let i=e.data,c=e.accessToken;i.fileId;(async function(e,t){const a={method:"POST",headers:{"Content-Type":"application/json",Authorization:t="JWT "+t},body:JSON.stringify(e)};let r;try{r=await fetch("https://figma-service.animaapp.com/generate/async",a)}catch(e){console.error(e)}if(200==r.status||201==r.status){n=!1;let e,a=await r.json();try{e=await async function e(t){let a=await async function(e,t){const n={method:"POST",headers:{"Content-Type":"application/json",Authorization:e.accessToken},body:JSON.stringify(e)};let a;try{a=await fetch("https://figma-service.animaapp.com/task/callback",n)}catch(e){console.error(e)}if(400===a.status)return a;if(200===a.status)return a;if(204===a.status)return chrome.tabs.getAllInWindow(e=>{e.map(e=>{chrome.tabs.sendMessage(e.id,{to:"AnimaStore",message:"add-percentage"},null,()=>{})})}),new Promise(e=>{setTimeout(()=>{e(a)},2e3)})}(t);if(a.error)return a;if(400===a.status)return a=await a.json(),a;if(204===a.status&&!n)return await e(t);if(200===a.status){return function(e){let t=e.project_short_id,n=e.homepage_slug,a=e.short_id;return`http://projects.animaapp.com/p/${t}/${a}/${n}/syncwebsite?extensionName=${window.extensionName}`}(await a.json())}if(n)return{error:"Error: convert Figma file to design failed"}}({taskId:a.taskId,accessToken:t})}catch(e){return{error:"Error: convert Figma file to design failed"}}if(e.error)return e;let o=e.replace("projects.","canary-projects.").replace("prototype","omniview"),s=e.replace("projects.animaapp.com","localhost:5002").replace("prototype","omniview").replace("https","http"),i=e.replace("prototype","omniview");return console.log("canaryUrl",o),console.log("localhostUrl",s),console.log("prodUrl",i),window.API_PROJECT.includes("https://projects.animaapp.com")?i:o}return 400===r.status?(r=await r.json(),{error:r.message}):{error:"Error: async design failed"}})(i,c).then(e=>{clearTimeout(a),e&&setTimeout(()=>{s(e)},2e3)})}return!0});let o=[]},37:function(e,t){let n,a=!1,r=[];chrome.runtime.onMessage.addListener((e,t,a)=>{let c={platform:"figma",to:e.type?e.type:"login"};return"getLoginUrl"===e.api?(t&&t.tab&&t.tab.id&&r.push(t.tab.id),clearTimeout(n),n=setTimeout(()=>{clearInterval(this.intervalInstance)},18e4),i(null,c,e.dontAddSource).then(e=>{a(e)})):"getFigmaAccessToken"===e.api?o(e.body,e.access_token):"checkIfWeHaveStorageUser"===e.api?a({userData:window.userData,access_token:window.access_token}):"getUserAfterLogin"===e.api&&l(e.data.pairingToken,c).then(e=>{t&&t.tab&&t.tab.id&&r.push(t.tab.id);let n={headers:{"X-Client-Id":"com.animaapp.figma","X-Client-Version":"0.0.1",Authorization:"JWT "+e.access_token}};s(n).then(t=>{window.userData=t,window.access_token=e.access_token,a({user:t,access_token:e.access_token})})}),!0});const o=async(e,t)=>{const n=window.API_URL+"/figma_token/generate",a={method:"POST",headers:{"Content-Type":"application/json","X-Client-Id":"com.animaapp.figma","X-Client-Version":"0.0.1",Authorization:"JWT "+t},body:e};await fetch(n,a)},s=async e=>{const t=window.API_URL+"/users/me",n={method:"GET",headers:{"Content-Type":"application/json"}};e.headers&&(n.headers=Object.assign(n.headers,e.headers));let a=await fetch(t,n);if(200==a.status){return await a.json()}{console.log("ERROR GETTING CURRENT USER > ",a);let e=await a.json();if(e.error){let t=new Error(e.description||"Something went wrong!");throw t.statusCode=e.status_code||a.status||500,t.error=e.error||"Error",t}{let e=new Error("Something went wrong!");throw e.statusCode=a.status||500,e.error="Error",e}}},i=async(e,t={},n)=>{try{if(!e){e=(await c(t)).token}let a=`${window.API_PROJECT}/${t&&t.to&&"signup"===t.to?"signup":"login"}?pairing=true&pt=${e}&platform=${t.platform}`;return t&&(a+=n||`&platform=${t.platform}&utm_medium=plugin&utm_source=figma&utm_content=signup-button`),{url:a,pairingToken:e}}catch(e){throw console.log("ERROR > GETTING BROWSER LOGIN URL > ",e),e}},c=async(e={})=>{try{a=!1;const t=window.API_URL+"/rpc/generate_pairing_token",n={method:"POST",headers:{"Content-Type":"application/json"}};e.headers&&(n.headers=Object.assign(n.headers,e.headers));let r=await fetch(t,n);if(200==r.status){return await r.json()}let o=await r.json();if(o.error){let e=new Error(o.description||"Something went wrong!");throw e.statusCode=o.status_code||r.status||500,e.error=o.error||"Error",e}{let e=new Error("Something went wrong!");throw e.statusCode=r.status||500,e.error="Error",e}}catch(e){throw console.log("ERROR > GENERATING PAIRING TOKEN > ",e),e}},l=async(e,t={})=>new Promise(async(n,r)=>{try{if(!e){let n=await this.generatePairingToken(t);e=n.token}const o=async()=>{try{let a=await u(e,t);a.result&&"ok"==a.result&&(clearInterval(this.intervalInstance),n(a))}catch(e){console.error("ERROR > GETTING ACCESS TOKEN > "),clearInterval(this.intervalInstance),r(e)}};a||(this.intervalInstance=setInterval(o,2e3))}catch(e){console.log("ERROR > GETTING ACCESS TOKEN > ",e),r(e)}}),u=async(e,t={})=>{try{const n=`${window.API_URL}/rpc/pairing_token?t=${e}`,a={method:"GET",headers:{"Content-Type":"application/json"}};t.headers&&(a.headers=Object.assign(a.headers,t.headers));let r=await fetch(n,a);if(200==r.status){return await r.json()}let o=await r.json();if(o.error){let e=new Error(o.description||"Something went wrong!");throw e.statusCode=o.status_code||r.status||500,404==e.statusCode&&(e.message="Failed to pair. Please try again!"),e.error=o.error||"Error",e}{let e=new Error("Something went wrong!");throw e.statusCode=r.status||500,404==e.statusCode&&(e.message="Failed to pair. Please try again!"),e.error="Error",e}}catch(e){throw console.log("ERROR > GENERATING AUTH URL > ",e),e}};function d(e){r.find(t=>t===e)&&clearInterval(this.intervalInstance)}chrome.tabs.onRemoved.addListener(e=>{d(e)}),chrome.tabs.onUpdated.addListener(e=>{d(e)})},38:function(e,t){let n=!1;function a(e,t,n,a={}){var o={eventCategory:"General",eventAction:e||"",uid:r};a.extensionName=window.extensionName,o.params=JSON.stringify(a);var s=function(e){var t="";for(var n in e)e.hasOwnProperty(n)&&(t.length>0&&(t+="&"),t+=encodeURI(n+"="+e[n]));return t}(o),i=new XMLHttpRequest;i.open("POST","https://logs.animaapp.com/analytics/collect",!0),i.setRequestHeader("Content-type","application/x-www-form-urlencoded"),i.setRequestHeader("X-User-Email",n||""),i.setRequestHeader("X-Client-Id","com.animaapp.chrome.extension"),i.setRequestHeader("X-Client-Version","1.0.0"),i.send(s)}chrome.runtime.onMessage.addListener((e,t,s)=>{if("trackEvent"===e.api){if(t&&t.origin&&"string"==typeof t.origin&&t.origin.includes(".figma.")){let t=e.params?e.params:{};a(e.eventName,e.userId,e.userEmail,t)}}else"firstRefresh"===e.api?(r=e.UUID,n&&(n=!1,setTimeout(()=>{a("chrome.extension.installed","","")},5e3))):"alias"===e.api&&async function(e,t){if(r&&e){const n={alias:e,distinct_id:r};try{let a="https://logs.animaapp.com/analytics/register_alias";await function(e,t,n,a){return new Promise((r,s)=>{const i=o(t),c=new XMLHttpRequest;c.open("POST",e,!0),c.setRequestHeader("Content-type","application/x-www-form-urlencoded"),c.setRequestHeader("X-User-Id",n||""),c.setRequestHeader("X-User-Email",a||""),c.setRequestHeader("X-Client-Id","com.animaapp.chrome.extension"),c.setRequestHeader("X-Client-Version","1.0.0");for(const e in this.headers){const t=this.headers[e];c.setRequestHeader(e,t)}c.onreadystatechange=function(){4===c.readyState&&200===c.status?s(c.response):r({status:c.status,statusText:c.statusText})},c.onerror=function(){r({status:c.status,statusText:c.statusText})},c.send(i)})}(a,n,e,t)}catch(e){console.log("register_alias failed",e)}}}(e.userId,e.email);return!0});let r=null;chrome.runtime.onInstalled.addListener((function(e){"install"==e.reason&&(n=!0)}));const o=e=>{let t="";for(let n in e)e.hasOwnProperty(n)&&(t.length>0&&(t+="&"),t+=encodeURI(n+"="+e[n]));return t}}});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL2JhY2tncm91bmQvYmFja2dyb3VuZC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvYmFja2dyb3VuZC9iYWNrZ3JvdW5kQ29uZmlnRmlsZS5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvYmFja2dyb3VuZC9iYWNrZ3JvdW5kR2V0RmlnbWFQcmV2aWV3LmpzIiwid2VicGFjazovLy8uL3NyYy9iYWNrZ3JvdW5kL2JhY2tncm91bmRMb2dpbi5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvYmFja2dyb3VuZC9iYWNrZ3JvdW5kVHJhY2tpbmcuanMiXSwibmFtZXMiOlsiaW5zdGFsbGVkTW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImV4cG9ydHMiLCJtb2R1bGUiLCJpIiwibCIsIm1vZHVsZXMiLCJjYWxsIiwibSIsImMiLCJkIiwibmFtZSIsImdldHRlciIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJyIiwiU3ltYm9sIiwidG9TdHJpbmdUYWciLCJ2YWx1ZSIsInQiLCJtb2RlIiwiX19lc01vZHVsZSIsIm5zIiwiY3JlYXRlIiwia2V5IiwiYmluZCIsIm4iLCJvYmplY3QiLCJwcm9wZXJ0eSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwicCIsInMiLCJhc3luYyIsImxvYWRVbmluc3RhbGxQYWdlIiwiZW1haWwiLCJ3aW5kb3ciLCJleHRlbnNpb25OYW1lIiwibG9hZEZyb21CYWNrZ3JvdW5kUGFnZSIsInVzZXJEYXRhIiwiY2hyb21lIiwicnVudGltZSIsInNldFVuaW5zdGFsbFVSTCIsIkFQSV9QUk9KRUNUIiwidXNlckxvZ2luIiwibWFpbkJ1dHRvbiIsImFjY2Vzc190b2tlbiIsIm9uTWVzc2FnZSIsImFkZExpc3RlbmVyIiwibWVzc2FnZSIsInNlbmRlciIsInNlbmRSZXNwb25zZSIsImFwaSIsInVybCIsImJvZHkiLCJtZXRob2QiLCJoZWFkZXJzIiwib3ZlcndyaXRlVXJsIiwicGFyYW1zIiwiYmFzZVVybCIsIkFQSV9VUkwiLCJyZXFPYmoiLCJKU09OIiwic3RyaW5naWZ5IiwicmVzcG9uc2UiLCJmZXRjaCIsInN0YXR1cyIsInRvVGV4dCIsInRleHQiLCJqc29uIiwiZXJyb3IiLCJkYXRhIiwiaGVhZGVyIiwidGhlbiIsInJlcyIsInRhYnMiLCJnZXRBbGxJbldpbmRvdyIsIm1hcCIsInRhYiIsInNlbmRNZXNzYWdlIiwiaWQiLCJpc0xvZ2luIiwib25JbnN0YWxsZWQiLCJkZXRhaWxzIiwicXVlcnkiLCJjdXJyZW50V2luZG93IiwiY29udGVudGpzRmlsZSIsImdldE1hbmlmZXN0IiwiY29udGVudF9zY3JpcHRzIiwianMiLCJpbmRleCIsImxlbmd0aCIsImV4ZWN1dGVTY3JpcHQiLCJmaWxlIiwicmVzdWx0Iiwib25VcGRhdGVkIiwidGFiSWQiLCJjaGFuZ2VJbmZvIiwiaW5jbHVkZXMiLCJzdG9wVHJ5VG9HZXREZXNpZ24iLCJzdG9wTG9va0ZvckRlc2lnblRpbWVvdXQiLCJ0YWJJZE9mRGVzaWduIiwiY2xlYXJUaW1lb3V0Iiwic2V0VGltZW91dCIsImNoZWNrVXBkYXRlZFRhYnMiLCJwdXNoIiwiYWNjZXNzVG9rZW4iLCJmaWxlSWQiLCJlIiwiY29uc29sZSIsInByZXZpZXciLCJnZXRGaWdtYURlc2lnbiIsInRvIiwiUHJvbWlzZSIsInJlc29sdmVkIiwiZ2V0RmlnbWFEZXNpZ25BUEkiLCJwcm9qZWN0U2hvcnRJZCIsInByb2plY3Rfc2hvcnRfaWQiLCJob21lcGFnZV9zbHVnIiwicmVsZWFzZVNob3J0SWQiLCJzaG9ydF9pZCIsImNvdmVydFdlYlVybCIsInRhc2tJZCIsImNhbmFyeVVybCIsInJlcGxhY2UiLCJsb2NhbGhvc3RVcmwiLCJwcm9kVXJsIiwibG9nIiwic3RhcnRGZXRjaGluZ0ZpZ21hRGVzZ2luIiwic3RvcExvb2tGb3JMb2dpblBvbGxpbmciLCJzdG9wUG9sbGluZyIsImNoZWNrVGFic0FyZVVwZGF0ZU9yUmVtb3ZlZCIsIm9wdGlvbnMiLCJwbGF0Zm9ybSIsInR5cGUiLCJjbGVhckludGVydmFsIiwidGhpcyIsImludGVydmFsSW5zdGFuY2UiLCJnZXRCcm93c2VyTG9naW5VcmwiLCJkb250QWRkU291cmNlIiwiYnJvd3NlclVybCIsImdldEZpZ21hQWNjZXNzVG9rZW4iLCJnZXRBY2Nlc3NUb2tlbiIsInBhaXJpbmdUb2tlbiIsImF1dGhPcHRpb25zIiwiQXV0aG9yaXphdGlvbiIsImN1cnJlbnRVc2VyIiwidXNlciIsImFzc2lnbiIsImVycm9yT2JqIiwiRXJyb3IiLCJkZXNjcmlwdGlvbiIsInN0YXR1c0NvZGUiLCJzdGF0dXNfY29kZSIsImdlbmVyYXRlUGFpcmluZ1Rva2VuIiwidG9rZW4iLCJleGVjIiwicmVzb2x2ZSIsInJlamVjdCIsInJlc3AiLCJjaGVja1BvbGxpbmdVcmwiLCJwb2xsaW5nVXJsIiwic2V0SW50ZXJ2YWwiLCJjaGVja0lmVGFiVXBkYXRlZDEiLCJmaW5kIiwiZmluZFRhYiIsIm9uUmVtb3ZlZCIsInNlbmRGaXJzdEluc3RhbGxFdmVudCIsInNlbmRUcmFja0V2ZW50IiwiZXZlbnROYW1lIiwidXNlcklkIiwidXNlckVtYWlsIiwiYXJncyIsImV2ZW50Q2F0ZWdvcnkiLCJldmVudEFjdGlvbiIsInVpZCIsIlVVSUQiLCJlbmNvZGVkU3RyaW5nIiwicHJvcCIsImVuY29kZVVSSSIsInBhcmFtZXRpemUiLCJodHRwIiwiWE1MSHR0cFJlcXVlc3QiLCJvcGVuIiwic2V0UmVxdWVzdEhlYWRlciIsInNlbmQiLCJvcmlnaW4iLCJhbGlhcyIsImRpc3RpbmN0X2lkIiwicGFyYW1ldGVyaXplIiwiaCIsInYiLCJvbnJlYWR5c3RhdGVjaGFuZ2UiLCJyZWFkeVN0YXRlIiwic3RhdHVzVGV4dCIsIm9uZXJyb3IiLCJzZW5kUmVxdWVzdCIsInJlYXNvbiIsIm9iaiJdLCJtYXBwaW5ncyI6ImFBQ0UsSUFBSUEsRUFBbUIsR0FHdkIsU0FBU0MsRUFBb0JD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QixJQUFLLElBQUlDLEtBQVFvQixFQUNYQSxFQUFJeEssZUFBZW9KLEtBQ2pCRCxFQUFjdEYsT0FBUyxJQUN6QnNGLEdBQWlCLEtBRW5CQSxHQUFpQkUsVUFBVUQsRUFBTyxJQUFNb0IsRUFBSXBCLEtBR2hELE9BQU9EIiwiZmlsZSI6ImJhY2tncm91bmQuYnVuZGxlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZ2V0dGVyIH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuIFx0XHR9XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBjcmVhdGUgYSBmYWtlIG5hbWVzcGFjZSBvYmplY3RcbiBcdC8vIG1vZGUgJiAxOiB2YWx1ZSBpcyBhIG1vZHVsZSBpZCwgcmVxdWlyZSBpdFxuIFx0Ly8gbW9kZSAmIDI6IG1lcmdlIGFsbCBwcm9wZXJ0aWVzIG9mIHZhbHVlIGludG8gdGhlIG5zXG4gXHQvLyBtb2RlICYgNDogcmV0dXJuIHZhbHVlIHdoZW4gYWxyZWFkeSBucyBvYmplY3RcbiBcdC8vIG1vZGUgJiA4fDE6IGJlaGF2ZSBsaWtlIHJlcXVpcmVcbiBcdF9fd2VicGFja19yZXF1aXJlX18udCA9IGZ1bmN0aW9uKHZhbHVlLCBtb2RlKSB7XG4gXHRcdGlmKG1vZGUgJiAxKSB2YWx1ZSA9IF9fd2VicGFja19yZXF1aXJlX18odmFsdWUpO1xuIFx0XHRpZihtb2RlICYgOCkgcmV0dXJuIHZhbHVlO1xuIFx0XHRpZigobW9kZSAmIDQpICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgJiYgdmFsdWUuX19lc01vZHVsZSkgcmV0dXJuIHZhbHVlO1xuIFx0XHR2YXIgbnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIobnMpO1xuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobnMsICdkZWZhdWx0JywgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdmFsdWUgfSk7XG4gXHRcdGlmKG1vZGUgJiAyICYmIHR5cGVvZiB2YWx1ZSAhPSAnc3RyaW5nJykgZm9yKHZhciBrZXkgaW4gdmFsdWUpIF9fd2VicGFja19yZXF1aXJlX18uZChucywga2V5LCBmdW5jdGlvbihrZXkpIHsgcmV0dXJuIHZhbHVlW2tleV07IH0uYmluZChudWxsLCBrZXkpKTtcbiBcdFx0cmV0dXJuIG5zO1xuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDM0KTtcbiIsImltcG9ydCBcIi4vYmFja2dyb3VuZENvbmZpZ0ZpbGUuanNcIjtcbmltcG9ydCBcIi4vYmFja2dyb3VuZEdldEZpZ21hUHJldmlld1wiO1xuaW1wb3J0IFwiLi9iYWNrZ3JvdW5kTG9naW4uanNcIjtcbmltcG9ydCBcIi4vYmFja2dyb3VuZFRyYWNraW5nLmpzXCI7XG5cbndpbmRvdy51c2VyTG9naW4gPSBmYWxzZTtcbndpbmRvdy5tYWluQnV0dG9uID0gXCJjb2RlXCI7XG53aW5kb3cuZXh0ZW5zaW9uTmFtZSA9IG51bGw7XG53aW5kb3cudXNlckRhdGE7XG53aW5kb3cuYWNjZXNzX3Rva2VuO1xuXG5jaHJvbWUucnVudGltZS5vbk1lc3NhZ2UuYWRkTGlzdGVuZXIoKG1lc3NhZ2UsIHNlbmRlciwgc2VuZFJlc3BvbnNlKSA9PiB7XG4gIC8qaWYgKG1lc3NhZ2UuYXBpID09PSBcImdldEZlYXR1cmVGbGFnXCIpIHtcbiAgICAgICAgbG9hZEZlYXR1cmVGbGFnKCkudGhlbigoZmVhdHVyZUZsYWdzKT0+e1xuICAgICAgICAgICAgc2VuZFJlc3BvbnNlKGZlYXR1cmVGbGFncylcbiAgICAgICAgfSlcbiAgICB9IFxuICAgIGVsc2UqLyBpZiAoXG4gICAgbWVzc2FnZS5hcGkgPT0gXCJzZW5kQXBpXCJcbiAgKSB7XG4gICAgYXBpKFxuICAgICAgbWVzc2FnZS51cmwsXG4gICAgICBtZXNzYWdlLmRhdGEsXG4gICAgICBtZXNzYWdlLm1ldGhvZCxcbiAgICAgIG1lc3NhZ2UuaGVhZGVyLFxuICAgICAgbWVzc2FnZS5vdmVyd3JpdGVVcmxcbiAgICApLnRoZW4oKHJlcykgPT4ge1xuICAgICAgc2VuZFJlc3BvbnNlKHJlcyk7XG4gICAgfSk7XG4gIH0gZWxzZSBpZiAobWVzc2FnZS5hcGkgPT09IFwibG9nb3V0XCIpIHtcbiAgICBsb2dvdXRJbkFsbFRhYnMoKTtcbiAgfSBlbHNlIGlmIChtZXNzYWdlLmFwaSA9PT0gXCJyZW1vdmVVc2VyQ2FjaGVcIikge1xuICAgIHdpbmRvdy51c2VyRGF0YSA9IG51bGw7XG4gICAgd2luZG93LmFjY2Vzc190b2tlbiA9IG51bGw7XG4gIH0gZWxzZSBpZiAobWVzc2FnZS5hcGkgPT09IFwibG9hZEZlYXR1cmVGbGFnXCIpIHtcbiAgICB3aW5kb3cubWFpbkJ1dHRvbiA9IG1lc3NhZ2UubWFpbkJ1dHRvbjtcbiAgICB3aW5kb3cuZXh0ZW5zaW9uTmFtZSA9IG1lc3NhZ2UuZXh0ZW5zaW9uTmFtZTtcbiAgICBsb2FkVW5pbnN0YWxsUGFnZSgpO1xuICB9IGVsc2UgaWYgKG1lc3NhZ2UuYXBpID09PSBcInVzZXJMb2dpblwiKSB7XG4gICAgd2luZG93LnVzZXJMb2dpbiA9IG1lc3NhZ2UuaXNMb2dpbjtcbiAgICBsb2FkVW5pbnN0YWxsUGFnZSgpO1xuICB9IGVsc2UgaWYgKG1lc3NhZ2UuYXBpID09PSBcInVwZGF0ZVVzZXJDYWNoZVwiKSB7XG4gICAgd2luZG93LnVzZXJEYXRhID0gbWVzc2FnZS51c2VyRGF0YTtcbiAgICB3aW5kb3cuYWNjZXNzX3Rva2VuID0gbWVzc2FnZS5hY2Nlc3NfdG9rZW47XG4gICAgbG9hZFVuaW5zdGFsbFBhZ2UoKTtcbiAgfVxuICByZXR1cm4gdHJ1ZTtcbn0pO1xuXG5mdW5jdGlvbiBsb2dvdXRJbkFsbFRhYnMoKSB7XG4gIHdpbmRvdy51c2VyRGF0YSA9IG51bGw7XG4gIHdpbmRvdy5hY2Nlc3NfdG9rZW4gPSBudWxsO1xuXG4gIC8vIGNocm9tZS5zdG9yYWdlLnN5bmMuc2V0KHsgYWNjZXNzX3Rva2VuOiAnJyB9LCBmdW5jdGlvbiAoeCkge30pO1xuICAvLyBjaHJvbWUuc3RvcmFnZS5zeW5jLnNldCh7IHVzZXJEYXRhOiB7fSB9LCBmdW5jdGlvbiAoeCkge30pO1xuICAvLyBjaHJvbWUuc3RvcmFnZS5zeW5jLnNldCh7Y2FjaGVQcm9qZWN0czpbXX0pLy9zYXZlIHRoYXQgdGhlIHByb2plY3QgaXMgcmVsYXRlZCBmb3IgdGhpcyB0ZWFtIGlkXG5cbiAgY2hyb21lLnRhYnMuZ2V0QWxsSW5XaW5kb3coKHRhYnMpID0+IHtcbiAgICB0YWJzLm1hcCgodGFiKSA9PiB7XG4gICAgICBjaHJvbWUudGFicy5zZW5kTWVzc2FnZSh0YWIuaWQsIHsgbWVzc2FnZTogXCJsb2dvdXRcIiB9LCBudWxsLCAoKSA9PiB7fSk7XG4gICAgfSk7XG4gIH0pO1xufVxuYXN5bmMgZnVuY3Rpb24gYXBpKFxuICB1cmwsXG4gIGJvZHksXG4gIG1ldGhvZCA9IFwiR0VUXCIsXG4gIGhlYWRlcnMsXG4gIG92ZXJ3cml0ZVVybCA9IGZhbHNlLFxuICBwYXJhbXNcbikge1xuICBsZXQgYmFzZVVybCA9XG4gICAgYm9keSAmJiBib2R5LmJhc2VVcmwgPT09IFwicHJvamVjdHNcIiA/IHdpbmRvdy5BUElfUFJPSkVDVCA6IHdpbmRvdy5BUElfVVJMO1xuXG4gIGlmIChoZWFkZXJzICYmIGhlYWRlcnMuYmFzZVVybCA9PT0gXCJsb2NhbGhvc3RcIikge1xuICAgIGJhc2VVcmwgPSBcImh0dHA6Ly9sb2NhbGhvc3Q6NTAwN1wiO1xuICB9XG4gIGNvbnN0IEFQSV9VUkwgPSBvdmVyd3JpdGVVcmwgPyB1cmwgOiBgJHtiYXNlVXJsfSR7dXJsfWA7XG5cbiAgaWYgKGJvZHkgJiYgYm9keS5iYXNlVXJsKSB7XG4gICAgZGVsZXRlIGJvZHkuYmFzZVVybDtcbiAgfVxuXG4gIGNvbnN0IHJlcU9iaiA9IHtcbiAgICBtZXRob2QsXG4gICAgaGVhZGVycyxcbiAgICBib2R5OiBib2R5ID8gSlNPTi5zdHJpbmdpZnkoYm9keSkgOiBudWxsLFxuICB9O1xuXG4gIGxldCByZXNwb25zZSA9IGF3YWl0IGZldGNoKEFQSV9VUkwsIHJlcU9iaik7XG5cbiAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PSAyMDApIHtcbiAgICBpZiAoaGVhZGVycyAmJiBoZWFkZXJzLnRvVGV4dCkge1xuICAgICAgbGV0IHRleHQgPSBhd2FpdCByZXNwb25zZS50ZXh0KCk7XG4gICAgICByZXR1cm4gdGV4dDtcbiAgICB9IGVsc2Uge1xuICAgICAgbGV0IGpzb24gPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gICAgICByZXR1cm4ganNvbjtcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgbGV0IGpzb24gPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gICAgcmV0dXJuIHsgZXJyb3I6IGpzb24gfTtcbiAgfVxufVxuLy8gYXN5bmMgZnVuY3Rpb24gbG9hZEZlYXR1cmVGbGFnKCl7XG4vLyAgICAgbGV0IHRleHQgPSAnJ1xuLy8gICAgIHRyeXtcbi8vICAgICAgICAgbGV0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goJ2h0dHBzOi8vZG9jcy5nb29nbGUuY29tL3NwcmVhZHNoZWV0cy9kLzEtcXIxUTFiT1ByTzgzbzBHRFpXMDNxTmdOZFREaFduWTBLRklRZTFUZXY4L2V4cG9ydD9mb3JtYXQ9Y3N2JmlkPTEtcXIxUTFiT1ByTzgzbzBHRFpXMDNxTmdOZFREaFduWTBLRklRZTFUZXY4JmdpZD0xMDcyMjUyNjkzJylcbi8vICAgICAgICAgdGV4dCA9IGF3YWl0IHJlc3BvbnNlLnRleHQoKTtcbi8vICAgICB9XG4vLyAgICAgY2F0Y2goZSl7XG4vLyAgICAgICAgIGNvbnNvbGUuZXJyb3IoZSlcbi8vICAgICB9XG5cbi8vICAgICByZXR1cm4gdGV4dFxuLy8gfVxuLy8gbG9hZEZlYXR1cmVGbGFnKClcblxuY2hyb21lLnJ1bnRpbWUub25JbnN0YWxsZWQuYWRkTGlzdGVuZXIoaW5zdGFsbFNjcmlwdCk7XG5cbmZ1bmN0aW9uIGluc3RhbGxTY3JpcHQoZGV0YWlscykge1xuICBjb25zdCBwYXJhbXMgPSB7XG4gICAgY3VycmVudFdpbmRvdzogdHJ1ZSxcbiAgfTtcblxuICBjaHJvbWUudGFicy5xdWVyeShwYXJhbXMsIGZ1bmN0aW9uIGdvdFRhYnModGFicykge1xuICAgIGNvbnN0IGNvbnRlbnRqc0ZpbGUgPSBjaHJvbWUucnVudGltZS5nZXRNYW5pZmVzdCgpLmNvbnRlbnRfc2NyaXB0c1swXS5qc1swXTtcbiAgICBmb3IgKGxldCBpbmRleCA9IDA7IGluZGV4IDwgdGFicy5sZW5ndGg7IGluZGV4KyspIHtcbiAgICAgIGNocm9tZS50YWJzLmV4ZWN1dGVTY3JpcHQoXG4gICAgICAgIHRhYnNbaW5kZXhdLmlkLFxuICAgICAgICB7XG4gICAgICAgICAgZmlsZTogY29udGVudGpzRmlsZSxcbiAgICAgICAgfSxcbiAgICAgICAgKHJlc3VsdCkgPT4ge31cbiAgICAgICk7XG4gICAgfVxuICB9KTtcbn1cblxuLy8gZnVuY3Rpb24gZ2V0VXNlcklkKCkge1xuLy8gICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmVkKSA9PiB7XG4vLyAgICAgd2luZG93LmNocm9tZS5zdG9yYWdlLnN5bmMuZ2V0KFwidXNlckRhdGFcIiwgKGRhdGEpID0+IHtcbi8vICAgICAgIHJlc29sdmVkKGRhdGEpXG4vLyAgICAgfSk7XG4vLyAgIH0pO1xuLy8gfVxuXG5mdW5jdGlvbiBnZXRFeHREYXRhKCkge1xuICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmVkKSA9PiB7XG4gICAgY2hyb21lLm1hbmFnZW1lbnQuZ2V0U2VsZigoZGF0YSkgPT4ge1xuICAgICAgcmVzb2x2ZWQoZGF0YSk7XG4gICAgfSk7XG4gIH0pO1xufVxuXG5hc3luYyBmdW5jdGlvbiBsb2FkVW5pbnN0YWxsUGFnZShlbWFpbCkge1xuICBpZiAod2luZG93LmV4dGVuc2lvbk5hbWUgIT09IFwiYW5pbWFcIiB8fCBsb2FkRnJvbUJhY2tncm91bmRQYWdlKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgaWYgKHdpbmRvdy51c2VyRGF0YSkge1xuICAgIGNvbnN0IGVtYWlsID1cbiAgICAgIHdpbmRvdy51c2VyRGF0YSAmJiB3aW5kb3cudXNlckRhdGEuZW1haWwgPyB3aW5kb3cudXNlckRhdGEuZW1haWwgOiBcIlwiO1xuXG4gICAgaWYgKGVtYWlsKSB7XG4gICAgICBjaHJvbWUucnVudGltZS5zZXRVbmluc3RhbGxVUkwoXG4gICAgICAgIGAke3dpbmRvdy5BUElfUFJPSkVDVH0vY2hyb21lLWV4dGVuc2lvbi11bmluc3RhbGw/ZW1haWw9JHtlbWFpbH1gXG4gICAgICApO1xuICAgIH0gZWxzZSB7XG4gICAgICBjaHJvbWUucnVudGltZS5zZXRVbmluc3RhbGxVUkwoXG4gICAgICAgIGAke3dpbmRvdy5BUElfUFJPSkVDVH0vY2hyb21lLWV4dGVuc2lvbi11bmluc3RhbGxgXG4gICAgICApO1xuICAgIH1cbiAgfVxufVxuLy8gY2hyb21lLnRhYnMub25VcGRhdGVkLmFkZExpc3RlbmVyKCh0YWJJZCxjaGFuZ2VJbmZvLHRhYikgPT4gey8vY2hlY2sgaWYgdGhlIHRhYiB1cGRhdGVkXG4vLyAgIGlmKHRhYi51cmwuaW5jbHVkZXMoJ2ZpZ21hLmNvbScpICYmIGNoYW5nZUluZm8uc3RhdHVzID09PSAnbG9hZGluZycgJiYgYWxsQnVuZGxlRmlsZSl7XG4vLyBjaHJvbWUudGFicy5leGVjdXRlU2NyaXB0KHRhYklkLHtcbi8vICAgICBjb2RlOiBhbGxCdW5kbGVGaWxlXG4vLyB9LChhLGIpPT57XG4vLyAgIGNvbnNvbGUubG9nKGEpXG4vLyAgIGNvbnNvbGUubG9nKGIpXG4vLyB9KVxuXG4vLyByZXR1cm5cbi8vIGNocm9tZS50YWJzLmV4ZWN1dGVTY3JpcHQodGFiSWQse1xuLy8gICBjb2RlOiBhbGxCdW5kbGVGaWxlLFxuLy8gICAvLyBmaWxlOlwiaHR0cDovL2xvY2FsaG9zdDozMDAwL3NoYXJlL2FwcC5idW5kbGUuanNcIixcbi8vICAgYWxsRnJhbWVzOiB0cnVlXG4vLyB9KTtcbi8vIGV4ZWN1dGluZy50aGVuKG9uRXhlY3V0ZWQsIG9uRXJyb3IpO1xuLy8gICB9XG4vLyB9KTtcblxubGV0IGxvYWRGcm9tQmFja2dyb3VuZFBhZ2UgPSB0cnVlO1xuXG5pZiAobG9hZEZyb21CYWNrZ3JvdW5kUGFnZSkge1xuICBjaHJvbWUudGFicy5vblVwZGF0ZWQuYWRkTGlzdGVuZXIoKHRhYklkLCBjaGFuZ2VJbmZvLCB0YWIpID0+IHtcbiAgICBpZiAoY2hhbmdlSW5mby5zdGF0dXMgPT09IFwiY29tcGxldGVcIiAmJiB0YWIudXJsLmluY2x1ZGVzKFwiZmlnbWEuY29tXCIpKSB7XG4gICAgICAvLyBjaHJvbWUudGFicy5leGVjdXRlU2NyaXB0KHRhYklkLCB7IGZpbGU6IFwiYXBwLmJ1bmRsZS5qc1wiIH0sICgpID0+IHt9KTtcbiAgICAgIGNocm9tZS50YWJzLmV4ZWN1dGVTY3JpcHQodGFiSWQsIHsgZmlsZTogXCJhcHAvYXBwLmJ1bmRsZS5qc1wiIH0sICgpID0+IHt9KTsgLy9mb3IgZ2l0SHViRGFya1xuICAgIH1cbiAgfSk7XG59XG4vLyBnZXRKc0ZpbGUoKVxuLy8gbGV0IGFsbEJ1bmRsZUZpbGVcbi8vIGFzeW5jIGZ1bmN0aW9uIGdldEpzRmlsZSgpe1xuLy8gICBsZXQgZGF0YSA9IGF3YWl0IGZldGNoKCdodHRwOi8vbG9jYWxob3N0OjMwMDAvc2hhcmUvYXBwLmJ1bmRsZS5qcycsIHtcbi8vICAgICBtZXRob2Q6ICdHRVQnLFxuLy8gICB9KTtcblxuLy8gICBkYXRhID0gYXdhaXQgZGF0YS50ZXh0KClcbi8vICAgYWxsQnVuZGxlRmlsZSA9IGRhdGFcbi8vIH1cbiIsIi8vIHdpbmRvdy5BUElfVVJMID0gJ2h0dHBzOi8vY2FuYXJ5LWFwaS5hbmltYWFwcC5jb20nXG4vLyB3aW5kb3cuQVBJX1BST0pFQ1QgPSAnaHR0cHM6Ly9jYW5hcnktcHJvamVjdHMuYW5pbWFhcHAuY29tJ1xuLy8gd2luZG93LkFQSV9QUk9KRUNUID0gJ2h0dHA6Ly9sb2NhbGhvc3Q6NTAwMidcbndpbmRvdy5BUElfVVJMID0gJ2h0dHBzOi8vYXBpLmFuaW1hYXBwLmNvbSdcbndpbmRvdy5BUElfUFJPSkVDVCA9ICdodHRwczovL3Byb2plY3RzLmFuaW1hYXBwLmNvbSciLCJ2YXIgc3RvcFRyeVRvR2V0RGVzaWduID0gZmFsc2VcbmxldCBzdG9wTG9va0ZvckRlc2lnblRpbWVvdXRcbmxldCB0YWJJZE9mRGVzaWduID0gbnVsbFxuXG5jaHJvbWUucnVudGltZS5vbk1lc3NhZ2UuYWRkTGlzdGVuZXIoKG1lc3NhZ2UsIHNlbmRlciwgc2VuZFJlc3BvbnNlKSA9PiB7XG4gICAgaWYgKG1lc3NhZ2UuYXBpID09PSBcImdldEZpZ21hRGVzaWduRnJvbUFuaW1hXCIpIHtcbiAgICAgICAgdGFiSWRPZkRlc2lnbiA9IHNlbmRlci50YWIuaWRcbiAgICAgICAgc3RvcFRyeVRvR2V0RGVzaWduID0gZmFsc2VcbiAgICAgICAgXG4gICAgICAgIGNsZWFyVGltZW91dChzdG9wTG9va0ZvckRlc2lnblRpbWVvdXQpXG4gICAgICAgIHN0b3BMb29rRm9yRGVzaWduVGltZW91dCA9IHNldFRpbWVvdXQoKCk9PnsvL2FmdGVyIDMgbWludXRlcyBzdG9wIHRyeWluZyB0byBnZXQgdGhlIGRlc2lnblxuICAgICAgICAgICAgc3RvcFRyeVRvR2V0RGVzaWduID0gdHJ1ZVxuICAgICAgICB9LCgzNjAgKiAxMDAwKSlcbiAgICAgICAgXG4gICAgICAgIGlmKHNlbmRlciAmJiBzZW5kZXIudGFiICYmIHNlbmRlci50YWIuaWQpey8vaWYgdGhpcyB0YWIgd2lsbCBjbG9zZSBvciBkZWxldGUgd2Ugd2lsbCBzdG9wIHRoZSBwb2xsaW5nXG4gICAgICAgICAgICBjaGVja1VwZGF0ZWRUYWJzLnB1c2goc2VuZGVyLnRhYi5pZCkvL3dlIHdpbGwgY2hlY2sgaWYgb25lIG9mIHRoZSB0YWJzIGluIHRoaXMgbGlzdCBoYXMgY2xvc2VkIG9yIHVwZGF0ZWRcbiAgICAgICAgfVxuICAgICAgICBsZXQgZGF0YSA9IG1lc3NhZ2UuZGF0YVxuICAgICAgICBsZXQgYWNjZXNzVG9rZW4gPSBtZXNzYWdlLmFjY2Vzc1Rva2VuXG5cbiAgICAgICAgbGV0IGZpbGVJZCA9IGRhdGEuZmlsZUlkXG4gICAgICAgIHN0YXJ0RmV0Y2hpbmdGaWdtYURlc2dpbihkYXRhLCBhY2Nlc3NUb2tlbikudGhlbih1cmw9PntcbiAgICAgICAgICAgIGNsZWFyVGltZW91dChzdG9wTG9va0ZvckRlc2lnblRpbWVvdXQpXG4gICAgICAgICAgICBpZih1cmwpe1xuICAgICAgICAgICAgICAgIC8vIGlmKCF1cmwuZXJyb3Ipe1xuICAgICAgICAgICAgICAgIC8vICAgICBzYXZlVXJsSW5DYWNoZSh1cmwsZmlsZUlkKVxuICAgICAgICAgICAgICAgIC8vIH1cbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpPT57XG4gICAgICAgICAgICAgICAgICAgIHNlbmRSZXNwb25zZSh1cmwpXG4gICAgICAgICAgICAgICAgfSwyMDAwKVxuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuICAgIH0gXG4gICAgXG4gICAgcmV0dXJuIHRydWVcbn0pO1xuXG4vLyBmdW5jdGlvbiBzYXZlVXJsSW5DYWNoZSh1cmwsZmlsZUlkKXsvL3NhdmUgdGhlIGRlc2lnbiBpbiBjYWNoZVxuLy8gICAgIGNocm9tZS5zdG9yYWdlLnN5bmMuZ2V0KCdleHBvcnRGaWxlcycsIChkYXRhKSA9PiB7XG4vLyAgICAgICAgIGxldCBmaWxlID0ge1xuLy8gICAgICAgICAgICAgICAgICAgICBmaWxlSWQsXG4vLyAgICAgICAgICAgICAgICAgICAgIHVybCxcbi8vICAgICAgICAgICAgICAgICAgICAgdGltZUhvdXI6bmV3IERhdGUoKS5nZXRIb3VycygpLFxuLy8gICAgICAgICAgICAgICAgICAgICBkYXk6IG5ldyBEYXRlKCkuZ2V0RGF0ZSgpXG4vLyAgICAgICAgICAgICAgICAgfVxuICAgICAgICBcbi8vICAgICAgICAgaWYoIWRhdGEgfHwgIWRhdGEuZXhwb3J0RmlsZXMpe1xuLy8gICAgICAgICAgICAgY2hyb21lLnN0b3JhZ2Uuc3luYy5zZXQoe2V4cG9ydEZpbGVzOltmaWxlXX0sIGZ1bmN0aW9uIChkYXRhKSB7fSk7XG4vLyAgICAgICAgIH1cbi8vICAgICAgICAgZWxzZSB7XG4vLyAgICAgICAgICAgICBkYXRhLmV4cG9ydEZpbGVzLnB1c2goZmlsZSlcbi8vICAgICAgICAgICAgIGxldCBmaW5kID0gZGF0YS5leHBvcnRGaWxlcy5maW5kKGRlc2lnbj0+e3JldHVybiBkZXNpZ24uZmlsZUlkPT09ZmlsZUlkfSlcbi8vICAgICAgICAgICAgIGlmKCFmaW5kKXtcbi8vICAgICAgICAgICAgICAgICBjaHJvbWUuc3RvcmFnZS5zeW5jLnNldCh7ZXhwb3J0RmlsZXM6ZGF0YS5leHBvcnRGaWxlc30sIGZ1bmN0aW9uIChkYXRhKSB7fSk7XG4vLyAgICAgICAgICAgICB9XG4vLyAgICAgICAgIH1cbi8vICAgICB9KTtcbi8vIH1cblxuLy8gZnVuY3Rpb24gY2hlY2tEZXNpZ25JblN0b3JhZ2UoZGF0YSl7XG4vLyAgICAgbGV0IGZpbGVJZCA9IGRhdGEuZmlsZUlkXG4vLyAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlZCk9Pntcbi8vICAgICAgICAgY2hyb21lLnN0b3JhZ2Uuc3luYy5nZXQoJ2V4cG9ydEZpbGVzJywgKGRhdGEpID0+IHtcbi8vICAgICAgICAgICAgIGlmKCFkYXRhIHx8ICFkYXRhLmV4cG9ydEZpbGVzKXtcbi8vICAgICAgICAgICAgICAgICByZXNvbHZlZCgpXG4vLyAgICAgICAgICAgICAgICAgcmV0dXJuXG4vLyAgICAgICAgICAgICB9XG4vLyAgICAgICAgICAgICBsZXQgZmluZCA9IGRhdGEuZXhwb3J0RmlsZXMuZmluZChkZXNpZ249PntyZXR1cm4gZGVzaWduLmZpbGVJZCA9PT0gZmlsZUlkICYmIGRlc2lnbi50aW1lSG91ciA9PT0gbmV3IERhdGUoKS5nZXRIb3VycygpfSlcbi8vICAgICAgICAgICAgIHJlc29sdmVkKGZpbmQpXG4vLyAgICAgICAgIH0pXG4vLyAgICAgfSlcbi8vIH1cbmFzeW5jIGZ1bmN0aW9uIHN0YXJ0RmV0Y2hpbmdGaWdtYURlc2dpbihib2R5LCBhY2Nlc3NUb2tlbil7XG4gICAgLy8gbGV0IGRlc2lnbkluU3RvcmFnZSA9IGF3YWl0IGNoZWNrRGVzaWduSW5TdG9yYWdlKGJvZHkpXG4gICAgLy8gaWYoZGVzaWduSW5TdG9yYWdlICYmIGRlc2lnbkluU3RvcmFnZS51cmwpe1xuICAgIC8vICAgICByZXR1cm4gZGVzaWduSW5TdG9yYWdlLnVybFxuICAgIC8vIH1cblxuICAgIC8vIGNvbnN0IEFQSV9VUkwgPSBgJHt3aW5kb3cuQVBJX1VSTH0vZmlnbWFfdG9rZW4vcHJldmlld19tb2RlbC9hc3luY2A7XG4gICAgLy8gY29uc3QgQVBJX1VSTCA9IGBodHRwczovL3VzLWNlbnRyYWwxLWFuaW1hLTIxNTkxOS5jbG91ZGZ1bmN0aW9ucy5uZXQvcHJvY2Vzc0ZpZ21hL2dlbmVyYXRlL2FzeW5jYDtcbiAgICBjb25zdCBBUElfVVJMID0gYGh0dHBzOi8vZmlnbWEtc2VydmljZS5hbmltYWFwcC5jb20vZ2VuZXJhdGUvYXN5bmNgO1xuICAgIFxuICAgIGFjY2Vzc1Rva2VuID0gYEpXVCAke2FjY2Vzc1Rva2VufWBcbiAgICBjb25zdCByZXFPYmogPSB7XG4gICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICAgICAgJ0F1dGhvcml6YXRpb24nOiBhY2Nlc3NUb2tlblxuICAgICAgICB9LFxuICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShib2R5KSxcbiAgICB9O1xuXG4gICAgbGV0IHJlc3BvbnNlXG4gICAgdHJ5e1xuICAgICAgICByZXNwb25zZSA9IGF3YWl0IGZldGNoKEFQSV9VUkwsIHJlcU9iaik7XG4gICAgfVxuICAgIGNhdGNoKGUpe1xuICAgICAgICBjb25zb2xlLmVycm9yKGUpXG4gICAgICAgIC8vIGlmKGUubWVzc2FnZSA9PT0gJ0ZhaWxlZCB0byBmZXRjaCcpe1xuICAgICAgICAvLyAgICAgcmV0dXJuIHtlcnJvcjonSW52YWxpZCB0b2tlbid9XG4gICAgICAgIC8vIH1cbiAgICB9XG5cbiAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09IDIwMCB8fCByZXNwb25zZS5zdGF0dXMgPT0gMjAxKSB7XG4gICAgICAgIHN0b3BUcnlUb0dldERlc2lnbiA9IGZhbHNlXG4gICAgICAgIFxuICAgICAgICBsZXQganNvbiA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcblxuICAgICAgICBsZXQgcHJldmlldyBcbiAgICAgICAgdHJ5e1xuICAgICAgICAgICAgcHJldmlldyA9IGF3YWl0IGdldEZpZ21hRGVzaWduKHt0YXNrSWQ6anNvbi50YXNrSWQsYWNjZXNzVG9rZW59KVxuICAgICAgICB9XG4gICAgICAgIGNhdGNoKGUpe1xuICAgICAgICAgICAgcmV0dXJuIHtlcnJvcjonRXJyb3I6IGNvbnZlcnQgRmlnbWEgZmlsZSB0byBkZXNpZ24gZmFpbGVkJ31cbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgaWYocHJldmlldy5lcnJvcil7XG4gICAgICAgICAgICByZXR1cm4gcHJldmlld1xuICAgICAgICB9XG5cbiAgICAgICAgbGV0IGNhbmFyeVVybCA9IHByZXZpZXcucmVwbGFjZSgncHJvamVjdHMuJywnY2FuYXJ5LXByb2plY3RzLicpLnJlcGxhY2UoJ3Byb3RvdHlwZScsJ29tbml2aWV3JylcbiAgICAgICAgbGV0IGxvY2FsaG9zdFVybCA9IHByZXZpZXcucmVwbGFjZSgncHJvamVjdHMuYW5pbWFhcHAuY29tJywnbG9jYWxob3N0OjUwMDInKS5yZXBsYWNlKCdwcm90b3R5cGUnLCdvbW5pdmlldycpLnJlcGxhY2UoJ2h0dHBzJywnaHR0cCcpXG4gICAgICAgIGxldCBwcm9kVXJsID0gcHJldmlldy5yZXBsYWNlKCdwcm90b3R5cGUnLCdvbW5pdmlldycpXG4gICAgICAgIFxuICAgICAgICBjb25zb2xlLmxvZygnY2FuYXJ5VXJsJyxjYW5hcnlVcmwpXG4gICAgICAgIGNvbnNvbGUubG9nKCdsb2NhbGhvc3RVcmwnLGxvY2FsaG9zdFVybClcbiAgICAgICAgY29uc29sZS5sb2coJ3Byb2RVcmwnLHByb2RVcmwpXG5cbiAgICAgICAgLy8gcmV0dXJuIGxvY2FsaG9zdFVybFxuICAgICAgICByZXR1cm4gd2luZG93LkFQSV9QUk9KRUNULmluY2x1ZGVzKCdodHRwczovL3Byb2plY3RzLmFuaW1hYXBwLmNvbScpID8gcHJvZFVybCA6IGNhbmFyeVVybFxuXG4gICAgICAgIC8vIGxldCBwcm9qZWN0SWQgPSBwcmV2aWV3LnNwbGl0KCcvcC8nKVsxXS5zcGxpdCgnLycpWzBdXG4gICAgICAgIC8vIGxldCBjb2RlRGVzaWduXG4gICAgICAgIC8vIHRyeXtcbiAgICAgICAgLy8gICAgIGNvZGVEZXNpZ24gPSBhd2FpdCBjb252ZXJ0RGVzaWduVG9Db2RlKHByZXZpZXcsIHByb2plY3RJZCwgYWNjZXNzVG9rZW4pXG4gICAgICAgIC8vIH1cbiAgICAgICAgLy8gY2F0Y2goZSl7XG4gICAgICAgIC8vICAgICByZXR1cm4ge2Vycm9yOidTeW5jIGRlc2lnbiB0byBBbmltYSBmYWlsZWQnfVxuICAgICAgICAvLyB9XG4gICAgICAgIC8vIGlmKGNvZGVEZXNpZ24uZXJyb3Ipe3JldHVybiBjb2RlRGVzaWdufVxuXG4gICAgICAgIC8vIGNocm9tZS50YWJzLnNlbmRNZXNzYWdlKHRhYklkLCB7dG86IFwiQW5pbWFTdG9yZVwiLGNoYW5nZVRleHQ6IFwiU3luY2luZ1wifSlcblxuICAgICAgICAvLyBsZXQgc3luY0Rlc2lnblJlcyA9IGF3YWl0IHN5bmNEZXNpZ24oY29kZURlc2lnbiwgcHJvamVjdElkLCBhY2Nlc3NUb2tlbilcbiAgICAgICAgLy8gaWYoc3luY0Rlc2lnblJlcy5lcnJvcil7cmV0dXJuIHN5bmNEZXNpZ25SZXN9XG5cbiAgICAgICAgLy8gbGV0IHBhZ2VOYW1lID0gc3luY0Rlc2lnblJlcy5wYWdlX25hbWVzID8gc3luY0Rlc2lnblJlcy5wYWdlX25hbWVzWzBdIDogJydcbiAgICAgICAgLy8gbGV0IHVybCA9IGAke3dpbmRvdy5BUElfUFJPSkVDVH0vdGVhbS9uZXcxLXA3em5ndmwvcHJvamVjdC8ke3N5bmNEZXNpZ25SZXMuc2hvcnRfaWR9L3NjcmVlbi8ke3BhZ2VOYW1lfS9vbW5pdmlld2BcbiAgICAgICAgXG4gICAgICAgIC8vIGxldCB1cmwgPSBgaHR0cDovL2xvY2FsaG9zdDo1MDAyL3RlYW0vbmV3MS1wN3puZ3ZsL3Byb2plY3QvJHtzeW5jRGVzaWduUmVzLnNob3J0X2lkfS9zY3JlZW4vJHtwYWdlTmFtZX0vb21uaXZpZXdgXG5cbiAgICAgICAgcmV0dXJuIHVybFxuICAgIH1cbiAgICBlbHNlIGlmKHJlc3BvbnNlLnN0YXR1cyA9PT0gNDAwKXtcbiAgICAgICAgcmVzcG9uc2UgPSBhd2FpdCByZXNwb25zZS5qc29uKClcbiAgICAgICAgcmV0dXJuIHtlcnJvcjpyZXNwb25zZS5tZXNzYWdlfVxuICAgIH1cbiAgICBlbHNle1xuICAgICAgICByZXR1cm4ge2Vycm9yOidFcnJvcjogYXN5bmMgZGVzaWduIGZhaWxlZCd9XG4gICAgfVxufVxuXG5hc3luYyBmdW5jdGlvbiBzeW5jRGVzaWduKGRhdGEsIHByb2plY3RJZCwgYWNjZXNzVG9rZW4pe1xuICAgIGNvbnN0IEFQSV9VUkwgPSBgJHt3aW5kb3cuQVBJX1VSTH0vdjIvcHJvamVjdHMvJHtwcm9qZWN0SWR9YDtcbiAgICBcbiAgICBsZXQgYm9keSA9IHtcImxpdmVfcHJvamVjdF9yZWxlYXNlXCI6e1widHlwZVwiOlwicHJvamVjdF9yZWxlYXNlc1wiLFwiaWRcIjpkYXRhLmlkfX1cbiAgICBjb25zdCByZXFPYmogPSB7XG4gICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICAgICAgJ0F1dGhvcml6YXRpb24nOiBhY2Nlc3NUb2tlblxuICAgICAgICB9LFxuICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShib2R5KSxcbiAgICB9O1xuXG4gICAgbGV0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goQVBJX1VSTCwgcmVxT2JqKTtcbiAgICB0cnl7XG4gICAgICAgIGxldCBqc29uID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICAgICAgICBpZihqc29uLmlzX3N5bmNpbmcgJiYgIXN0b3BUcnlUb0dldERlc2lnbil7XG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmVkKT0+e1xuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCk9PntcbiAgICAgICAgICAgICAgICAgICAgICAgIHN5bmNEZXNpZ24oZGF0YSxwcm9qZWN0SWQsYWNjZXNzVG9rZW4pLnRoZW4oZGF0YT0+e1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZWQoZGF0YSlcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICB9LDIwMDApXG4gICAgICAgICAgICB9KVxuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYoc3RvcFRyeVRvR2V0RGVzaWduKXtcbiAgICAgICAgICAgIHJldHVybiB7ZXJyb3I6XCJDYW4ndCBleHBvcnQgdGhlIGRlc2lnbiB0byBBbmltYVwifVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGpzb25cbiAgICB9XG4gICAgY2F0Y2goZSl7XG4gICAgICAgIHJldHVybiB7ZXJyb3I6XCJDYW4ndCBleHBvcnQgdGhlIGRlc2lnbiB0byBBbmltYVwifVxuICAgIH1cbn1cbmFzeW5jIGZ1bmN0aW9uIGNvbnZlcnREZXNpZ25Ub0NvZGUocHJldmlldywgcHJvamVjdElkLCBhY2Nlc3NUb2tlbil7XG4gICAgY29uc3QgQVBJX1VSTCA9IGAke3dpbmRvdy5BUElfVVJMfS92Mi9wcm9qZWN0cy8ke3Byb2plY3RJZH0vcHJvamVjdF9yZWxlYXNlc2A7XG4gICAgXG4gICAgbGV0IHNob3J0SWQgPSBwcmV2aWV3LnNwbGl0KCcvcC8nKVsxXS5zcGxpdCgnLycpWzFdXG4gICAgbGV0IGJvZHkgPSB7XCJyZWxlYXNlXCI6e1widHlwZVwiOlwicmVsZWFzZXNcIixcInNob3J0X2lkXCI6c2hvcnRJZH19XG4gICAgY29uc3QgcmVxT2JqID0ge1xuICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgICAgICdBdXRob3JpemF0aW9uJzogYWNjZXNzVG9rZW5cbiAgICAgICAgfSxcbiAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoYm9keSksXG4gICAgfTtcbiAgICBcbiAgICBsZXQgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChBUElfVVJMLCByZXFPYmopO1xuICAgIGxldCBqc29uID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICAgIFxuICAgIHJldHVybiBqc29uXG59XG5cbmZ1bmN0aW9uIGNvdmVydFdlYlVybCh1cmwpe1xuICAgIGxldCBwcm9qZWN0U2hvcnRJZCA9IHVybC5wcm9qZWN0X3Nob3J0X2lkXG4gICAgbGV0IGhvbWVwYWdlX3NsdWcgPSB1cmwuaG9tZXBhZ2Vfc2x1Z1xuICAgIGxldCByZWxlYXNlU2hvcnRJZCA9IHVybC5zaG9ydF9pZFxuXG4gICAgLy8gcmV0dXJuIGBodHRwOi8vbG9jYWxob3N0OjUwMDIvcC8ke3Byb2plY3RTaG9ydElkfS8ke3JlbGVhc2VTaG9ydElkfS8ke2hvbWVwYWdlX3NsdWd9L3N5bmN3ZWJzaXRlP2V4dGVuc2lvbk5hbWU9JHt3aW5kb3cuZXh0ZW5zaW9uTmFtZX1gXG4gICAgcmV0dXJuIGBodHRwOi8vcHJvamVjdHMuYW5pbWFhcHAuY29tL3AvJHtwcm9qZWN0U2hvcnRJZH0vJHtyZWxlYXNlU2hvcnRJZH0vJHtob21lcGFnZV9zbHVnfS9zeW5jd2Vic2l0ZT9leHRlbnNpb25OYW1lPSR7d2luZG93LmV4dGVuc2lvbk5hbWV9YFxufVxuXG5hc3luYyBmdW5jdGlvbiBnZXRGaWdtYURlc2lnbihib2R5KXtcbiAgICBsZXQgcmVzcG9uc2UgPSBhd2FpdCBnZXRGaWdtYURlc2lnbkFQSShib2R5KVxuXG4gICAgaWYocmVzcG9uc2UuZXJyb3Ipe1xuICAgICAgICByZXR1cm4gcmVzcG9uc2VcbiAgICB9XG4gICAgZWxzZSBpZihyZXNwb25zZS5zdGF0dXMgPT09IDQwMCl7XG4gICAgICAgIHJlc3BvbnNlID0gYXdhaXQgcmVzcG9uc2UuanNvbigpXG4gICAgICAgIHJldHVybiByZXNwb25zZVxuICAgIH1cbiAgICBlbHNlIGlmKHJlc3BvbnNlLnN0YXR1cyA9PT0gMjA0ICYmICFzdG9wVHJ5VG9HZXREZXNpZ24pIHtcbiAgICAgICAgcmV0dXJuIGF3YWl0IGdldEZpZ21hRGVzaWduKGJvZHkpXG4gICAgfVxuICAgIGVsc2UgaWYocmVzcG9uc2Uuc3RhdHVzID09PSAyMDApIHtcbiAgICAgICAgbGV0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gY292ZXJ0V2ViVXJsKGRhdGEpXG4gICAgfVxuICAgIGVsc2UgaWYoc3RvcFRyeVRvR2V0RGVzaWduKXtcbiAgICAgICAgcmV0dXJuIHtlcnJvcjonRXJyb3I6IGNvbnZlcnQgRmlnbWEgZmlsZSB0byBkZXNpZ24gZmFpbGVkJ31cbiAgICB9XG59XG5hc3luYyBmdW5jdGlvbiBnZXRGaWdtYURlc2lnbkFQSShib2R5LGFjY2Vzc1Rva2VuKXtcbiAgICAvLyBjb25zdCBBUElfVVJMID0gYCR7d2luZG93LkFQSV9VUkx9L2ZpZ21hX3Rva2VuL3Rhc2svY2FsbGJhY2tgO1xuICAgIC8vIGNvbnN0IEFQSV9VUkwgPSBgaHR0cHM6Ly91cy1jZW50cmFsMS1hbmltYS0yMTU5MTkuY2xvdWRmdW5jdGlvbnMubmV0L3Byb2Nlc3NGaWdtYS90YXNrL2NhbGxiYWNrYDtcbiAgICAvLyBjb25zdCBBUElfVVJMID0gYGh0dHBzOi8vYXBpLmFuaW1hYXBwLmNvbS9maWdtYV90b2tlbi90YXNrL2NhbGxiYWNrYDtcbiAgICBjb25zdCBBUElfVVJMID0gYGh0dHBzOi8vZmlnbWEtc2VydmljZS5hbmltYWFwcC5jb20vdGFzay9jYWxsYmFja2A7XG5cbiAgICBjb25zdCByZXFPYmogPSB7XG4gICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICAgICAgJ0F1dGhvcml6YXRpb24nOiBib2R5LmFjY2Vzc1Rva2VuXG4gICAgICAgIH0sXG4gICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KGJvZHkpLFxuICAgIH07XG5cblxuICAgIGxldCByZXNwb25zZVxuICAgIHRyeXtcbiAgICAgICAgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChBUElfVVJMLCByZXFPYmopO1xuICAgIH1cbiAgICBjYXRjaChlKXtcbiAgICAgICAgY29uc29sZS5lcnJvcihlKVxuICAgICAgICAvLyBpZihlLm1lc3NhZ2UgPT09ICdGYWlsZWQgdG8gZmV0Y2gnKXtcbiAgICAgICAgLy8gICAgIHJldHVybiB7ZXJyb3I6J0ludmFsaWQgdG9rZW4nfVxuICAgICAgICAvLyB9XG4gICAgfVxuICAgIFxuICAgIGlmKHJlc3BvbnNlLnN0YXR1cyA9PT0gNDAwKXtcbiAgICAgICAgcmV0dXJuIHJlc3BvbnNlXG4gICAgfVxuICAgIGVsc2UgaWYocmVzcG9uc2Uuc3RhdHVzID09PSAyMDApe1xuICAgICAgICByZXR1cm4gcmVzcG9uc2VcbiAgICB9XG4gICAgZWxzZSBpZihyZXNwb25zZS5zdGF0dXMgPT09IDIwNCl7Ly9pZiB0aGUgZmlsZSBpcyBzdGlsbCBwcm9jZXNzaW5nIHdhaXQgZm9yIDEgc2Vjb25kc1xuICAgICAgICBjaHJvbWUudGFicy5nZXRBbGxJbldpbmRvdygodGFicyk9PntcbiAgICAgICAgICAgIHRhYnMubWFwKHRhYj0+e1xuICAgICAgICAgICAgICBjaHJvbWUudGFicy5zZW5kTWVzc2FnZSh0YWIuaWQsIHt0bzonQW5pbWFTdG9yZScsbWVzc2FnZTonYWRkLXBlcmNlbnRhZ2UnfSwgbnVsbCwgKCk9Pnt9KVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfSlcblxuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmVkKT0+e1xuICAgICAgICAgICAgc2V0VGltZW91dCgoKT0+e1xuICAgICAgICAgICAgICAgIHJlc29sdmVkKHJlc3BvbnNlKVxuICAgICAgICAgICAgfSwyMDAwKVxuICAgICAgICB9KVxuICAgIH1cbn1cblxubGV0IGNoZWNrVXBkYXRlZFRhYnMgPSBbXVxuLy8gY2hyb21lLnRhYnMub25SZW1vdmVkLmFkZExpc3RlbmVyKCh0YWJJZCkgPT4gey8vY2hlY2sgaWYgdGhlIHRhYiBkZWxldGVkXG4vLyAgICAgaWYodGFiSWQgPT09IHRhYklkT2ZEZXNpZ24pe1xuLy8gICAgICAgICBjaGVja0lmVGFiVXBkYXRlZCh0YWJJZClcbi8vICAgICB9XG4vLyB9KTtcblxuLy8gY2hyb21lLnRhYnMub25VcGRhdGVkLmFkZExpc3RlbmVyKCh0YWJJZCxjaGFuZ2VJbmZvLHRhYikgPT4gey8vY2hlY2sgaWYgdGhlIHRhYiB1cGRhdGVkXG4vLyAgICAgY29uc29sZS5sb2coJ2NoYW5nZUluZm8uc3RhdHVzJyxjaGFuZ2VJbmZvLnN0YXR1cylcbi8vICAgICBpZih0YWIudXJsLmluY2x1ZGVzKCdmaWdtYS5jb20nKSAmJiBjaGFuZ2VJbmZvLnN0YXR1cyA9PT0gJ2xvYWRpbmcnKXtcbi8vICAgICAgICAgY2hyb21lLnRhYnMuZXhlY3V0ZVNjcmlwdCh0YWJJZCx7XG4vLyAgICAgICAgICAgICBjb2RlOiBgYWxlcnQoJ2kgYW0gaGVyZScpO2Bcbi8vICAgICAgICAgfSlcbi8vICAgICB9XG4vLyAgICAgLy8gaWYoY2hhbmdlSW5mby5zdGF0dXMgPT09ICdsb2FkaW5nJyAmJiB0YWJJZCA9PT0gdGFiSWRPZkRlc2lnbil7XG4vLyAgICAgLy8gICAgIGNoZWNrSWZUYWJVcGRhdGVkKHRhYklkKVxuLy8gICAgIC8vIH1cbi8vIH0pO1xuLy8gZnVuY3Rpb24gY2hlY2tJZlRhYlVwZGF0ZWQodGFiSWQpey8vaWYgdGhlIHRhYiBkZWxldGVkIG9yIHVwZGF0ZWQgc3RvcCB0aGUgcG9sbGluZ1xuLy8gICAgIGxldCBmaW5kSWZSZWZyZXNoZWQgPSBjaGVja1VwZGF0ZWRUYWJzLmZpbmQoZmluZFRhYj0+ZmluZFRhYj09PXRhYklkKVxuLy8gICAgIGlmKGZpbmRJZlJlZnJlc2hlZCl7XG4vLyAgICAgICAgIHN0b3BUcnlUb0dldERlc2lnbiA9IHRydWVcbi8vICAgICB9XG4vLyB9ICIsImxldCBzdG9wUG9sbGluZyA9IGZhbHNlXG5sZXQgY2hlY2tUYWJzQXJlVXBkYXRlT3JSZW1vdmVkID0gW11cbmxldCBzdG9wTG9va0ZvckxvZ2luUG9sbGluZ1xuXG5jaHJvbWUucnVudGltZS5vbk1lc3NhZ2UuYWRkTGlzdGVuZXIoKG1lc3NhZ2UsIHNlbmRlciwgc2VuZFJlc3BvbnNlKSA9PiB7XG4gICAgbGV0IG9wdGlvbnMgPSB7IHBsYXRmb3JtOiAnZmlnbWEnLCB0bzogbWVzc2FnZS50eXBlID8gbWVzc2FnZS50eXBlIDogJ2xvZ2luJ307XG4gICAgaWYgKG1lc3NhZ2UuYXBpID09PSBcImdldExvZ2luVXJsXCIpIHtcbiAgICAgIGlmKHNlbmRlciAmJiBzZW5kZXIudGFiICYmIHNlbmRlci50YWIuaWQpey8vaWYgdGhpcyB0YWIgd2lsbCBjbG9zZSBvciBkZWxldGUgd2Ugd2lsbCBzdG9wIHRoZSBwb2xsaW5nXG4gICAgICAgIGNoZWNrVGFic0FyZVVwZGF0ZU9yUmVtb3ZlZC5wdXNoKHNlbmRlci50YWIuaWQpLy93ZSB3aWxsIGNoZWNrIGlmIG9uZSBvZiB0aGUgdGFicyBpbiB0aGlzIGxpc3QgaGFzIGNsb3NlZCBvciB1cGRhdGVkXG4gICAgICB9XG4gICAgICBcbiAgICAgIGNsZWFyVGltZW91dChzdG9wTG9va0ZvckxvZ2luUG9sbGluZylcbiAgICAgIHN0b3BMb29rRm9yTG9naW5Qb2xsaW5nID0gc2V0VGltZW91dCgoKT0+ey8vc3RvcCB0aGUgcG9sbGluZyBhZnRlciAzIG1pbnV0ZXNcbiAgICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLmludGVydmFsSW5zdGFuY2UpXG4gICAgICB9LDE4MCAqIDEwMDApXG4gICAgICBcbiAgICAgIGdldEJyb3dzZXJMb2dpblVybChudWxsLCBvcHRpb25zICxtZXNzYWdlLmRvbnRBZGRTb3VyY2UpLnRoZW4oKGJyb3dzZXJVcmwpPT57XG4gICAgICAgICAgc2VuZFJlc3BvbnNlKGJyb3dzZXJVcmwpXG4gICAgICB9KVxuICAgIH0gXG4gICAgZWxzZSBpZihtZXNzYWdlLmFwaSA9PT0gXCJnZXRGaWdtYUFjY2Vzc1Rva2VuXCIpe1xuICAgICAgZ2V0RmlnbWFBY2Nlc3NUb2tlbihtZXNzYWdlLmJvZHksIG1lc3NhZ2UuYWNjZXNzX3Rva2VuKVxuICAgIH1cbiAgICBlbHNlIGlmKG1lc3NhZ2UuYXBpID09PSAnY2hlY2tJZldlSGF2ZVN0b3JhZ2VVc2VyJyl7XG4gICAgICBzZW5kUmVzcG9uc2Uoe3VzZXJEYXRhOndpbmRvdy51c2VyRGF0YSwgYWNjZXNzX3Rva2VuOndpbmRvdy5hY2Nlc3NfdG9rZW59KVxuICAgIH1cbiAgICBlbHNlIGlmIChtZXNzYWdlLmFwaSA9PT0gJ2dldFVzZXJBZnRlckxvZ2luJyl7XG4gICAgICAgIGdldEFjY2Vzc1Rva2VuKG1lc3NhZ2UuZGF0YS5wYWlyaW5nVG9rZW4gLG9wdGlvbnMpLnRoZW4oKGRhdGEpPT57XG4gICAgICAgICAgaWYoc2VuZGVyICYmIHNlbmRlci50YWIgJiYgc2VuZGVyLnRhYi5pZCl7XG4gICAgICAgICAgICBjaGVja1RhYnNBcmVVcGRhdGVPclJlbW92ZWQucHVzaChzZW5kZXIudGFiLmlkKVxuICAgICAgICAgIH1cblxuICAgICAgICAgIGxldCBhdXRoT3B0aW9ucyA9IHtcbiAgICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICAgJ1gtQ2xpZW50LUlkJzogJ2NvbS5hbmltYWFwcC5maWdtYScsXG4gICAgICAgICAgICAgICdYLUNsaWVudC1WZXJzaW9uJzogJzAuMC4xJyxcbiAgICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogYEpXVCAke2RhdGEuYWNjZXNzX3Rva2VufWAsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH07XG5cbiAgICAgICAgICBjdXJyZW50VXNlcihhdXRoT3B0aW9ucykudGhlbih1c2VyPT57XG4gICAgICAgICAgICB3aW5kb3cudXNlckRhdGEgPSB1c2VyXG4gICAgICAgICAgICB3aW5kb3cuYWNjZXNzX3Rva2VuID0gZGF0YS5hY2Nlc3NfdG9rZW5cblxuICAgICAgICAgICAgLy8gY2hyb21lLnN0b3JhZ2Uuc3luYy5zZXQoeyBhY2Nlc3NfdG9rZW46IGRhdGEuYWNjZXNzX3Rva2VuIH0sIGZ1bmN0aW9uICh4KSB7fSk7XG4gICAgICAgICAgICAvLyBjaHJvbWUuc3RvcmFnZS5zeW5jLnNldCh7IHVzZXJEYXRhOiB1c2VyIH0sIGZ1bmN0aW9uICh4KSB7fSk7XG5cbiAgICAgICAgICAgIHNlbmRSZXNwb25zZSh7dXNlciwgYWNjZXNzX3Rva2VuOmRhdGEuYWNjZXNzX3Rva2VufSlcbiAgICAgICAgICB9KVxuICAgICAgICB9KVxuICAgIH1cbiAgICByZXR1cm4gdHJ1ZVxufSk7XG5cbmNvbnN0IGdldEZpZ21hQWNjZXNzVG9rZW4gPSBhc3luYyAoYm9keSwgYWNjZXNzX3Rva2VuKSA9PiB7XG4gIGNvbnN0IEFQSV9VUkwgPSBgJHt3aW5kb3cuQVBJX1VSTH0vZmlnbWFfdG9rZW4vZ2VuZXJhdGVgO1xuXG4gIGNvbnN0IHJlcU9iaiA9IHtcbiAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICBoZWFkZXJzOiB7XG4gICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgJ1gtQ2xpZW50LUlkJzogJ2NvbS5hbmltYWFwcC5maWdtYScsXG4gICAgICAnWC1DbGllbnQtVmVyc2lvbic6ICcwLjAuMScsXG4gICAgICBBdXRob3JpemF0aW9uOiBgSldUICR7YWNjZXNzX3Rva2VufWBcbiAgICB9LFxuICAgIGJvZHlcbiAgfTtcbiAgbGV0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goQVBJX1VSTCwgcmVxT2JqKTtcbn1cblxuY29uc3QgY3VycmVudFVzZXIgPSBhc3luYyAob3B0aW9ucykgPT4ge1xuICAgIGNvbnN0IEFQSV9VUkwgPSBgJHt3aW5kb3cuQVBJX1VSTH0vdXNlcnMvbWVgO1xuICBcbiAgICBjb25zdCBBVVRIX0hFQURFUlMgPSB7XG4gICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgIH07XG4gIFxuICAgIGNvbnN0IHJlcU9iaiA9IHtcbiAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICBoZWFkZXJzOiBBVVRIX0hFQURFUlMsXG4gICAgfTtcbiAgXG4gICAgaWYgKG9wdGlvbnMuaGVhZGVycykge1xuICAgICAgcmVxT2JqLmhlYWRlcnMgPSBPYmplY3QuYXNzaWduKHJlcU9iai5oZWFkZXJzLCBvcHRpb25zLmhlYWRlcnMpO1xuICAgIH1cbiAgXG4gICAgbGV0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goQVBJX1VSTCwgcmVxT2JqKTtcbiAgXG4gICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PSAyMDApIHtcbiAgICAgIGxldCBqc29uID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICAgICAgcmV0dXJuIGpzb247XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnNvbGUubG9nKCdFUlJPUiBHRVRUSU5HIENVUlJFTlQgVVNFUiA+ICcsIHJlc3BvbnNlKTtcbiAgICAgIGxldCBqc29uID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICAgICAgaWYgKGpzb24uZXJyb3IpIHtcbiAgICAgICAgbGV0IGVycm9yT2JqID0gbmV3IEVycm9yKGpzb24uZGVzY3JpcHRpb24gfHwgJ1NvbWV0aGluZyB3ZW50IHdyb25nIScpO1xuICAgICAgICBlcnJvck9iai5zdGF0dXNDb2RlID0ganNvbi5zdGF0dXNfY29kZSB8fCByZXNwb25zZS5zdGF0dXMgfHwgNTAwO1xuICAgICAgICBlcnJvck9iai5lcnJvciA9IGpzb24uZXJyb3IgfHwgJ0Vycm9yJztcbiAgICAgICAgdGhyb3cgZXJyb3JPYmo7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBsZXQgZXJyb3JPYmogPSBuZXcgRXJyb3IoJ1NvbWV0aGluZyB3ZW50IHdyb25nIScpO1xuICAgICAgICBlcnJvck9iai5zdGF0dXNDb2RlID0gcmVzcG9uc2Uuc3RhdHVzIHx8IDUwMDtcbiAgICAgICAgZXJyb3JPYmouZXJyb3IgPSAnRXJyb3InO1xuICAgICAgICB0aHJvdyBlcnJvck9iajtcbiAgICAgIH1cbiAgICB9XG4gIH07XG5cbmNvbnN0IGdldEJyb3dzZXJMb2dpblVybCA9IGFzeW5jIChwYWlyaW5nVG9rZW4sIG9wdGlvbnMgPSB7fSwgZG9udEFkZFNvdXJjZSkgPT4ge1xuICAgIHRyeSB7XG4gICAgICAgIGlmICghcGFpcmluZ1Rva2VuKSB7XG4gICAgICAgICAgICBsZXQgcmVzcCA9IGF3YWl0IGdlbmVyYXRlUGFpcmluZ1Rva2VuKG9wdGlvbnMpO1xuICAgICAgICAgICAgcGFpcmluZ1Rva2VuID0gcmVzcC50b2tlbjtcbiAgICAgICAgfVxuICAgICAgICAvL2J1aWxkIHRoZSB1cmxcbiAgICAgICAgbGV0IHVybCA9IGAke3dpbmRvdy5BUElfUFJPSkVDVH0vJHtvcHRpb25zICYmIG9wdGlvbnMudG8gJiYgb3B0aW9ucy50bz09PSdzaWdudXAnID8gJ3NpZ251cCcgOiAnbG9naW4nfT9wYWlyaW5nPXRydWUmcHQ9JHtwYWlyaW5nVG9rZW59JnBsYXRmb3JtPSR7b3B0aW9ucy5wbGF0Zm9ybX1gXG5cbiAgICAgICAgaWYob3B0aW9ucyAvKiYmIG9wdGlvbnMudG8gPT09ICdzaWdudXAnKi8pey8vaWYgaXQncyBzaWdudXAgZmxvdyBhZGQgbW9yZSBwYXJhbXNcbiAgICAgICAgICAgIHVybCA9IHVybCArIChkb250QWRkU291cmNlID8gZG9udEFkZFNvdXJjZSA6IGAmcGxhdGZvcm09JHtvcHRpb25zLnBsYXRmb3JtfSZ1dG1fbWVkaXVtPXBsdWdpbiZ1dG1fc291cmNlPWZpZ21hJnV0bV9jb250ZW50PXNpZ251cC1idXR0b25gKVxuICAgICAgICB9XG5cbiAgICAgICAgbGV0IHJlc3BPYmogPSB7XG4gICAgICAgICAgICB1cmwsXG4gICAgICAgICAgICBwYWlyaW5nVG9rZW4sXG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiByZXNwT2JqO1xuICAgIH0gY2F0Y2ggKGV4ZWMpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ0VSUk9SID4gR0VUVElORyBCUk9XU0VSIExPR0lOIFVSTCA+ICcsIGV4ZWMpO1xuICAgICAgICB0aHJvdyBleGVjO1xuICAgIH1cbn1cblxuY29uc3QgZ2VuZXJhdGVQYWlyaW5nVG9rZW4gPSBhc3luYyAob3B0aW9ucyA9IHt9KSA9PiB7XG4gICAgdHJ5IHtcbiAgICAgIHN0b3BQb2xsaW5nID0gZmFsc2U7XG4gICAgICBjb25zdCBBUElfVVJMID0gYCR7d2luZG93LkFQSV9VUkx9L3JwYy9nZW5lcmF0ZV9wYWlyaW5nX3Rva2VuYDtcblxuICAgICAgY29uc3QgcmVxT2JqID0ge1xuICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgIH0sXG4gICAgICB9O1xuXG4gICAgICBpZiAob3B0aW9ucy5oZWFkZXJzKSB7XG4gICAgICAgIHJlcU9iai5oZWFkZXJzID0gT2JqZWN0LmFzc2lnbihyZXFPYmouaGVhZGVycywgb3B0aW9ucy5oZWFkZXJzKTtcbiAgICAgIH1cblxuICAgICAgbGV0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goQVBJX1VSTCwgcmVxT2JqKTtcbiAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT0gMjAwKSB7XG4gICAgICAgIGxldCBqc29uID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICAgICAgICByZXR1cm4ganNvbjtcbiAgICAgIH1cbiAgICAgIGxldCBqc29uID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICAgICAgaWYgKGpzb24uZXJyb3IpIHtcbiAgICAgICAgbGV0IGVycm9yT2JqID0gbmV3IEVycm9yKGpzb24uZGVzY3JpcHRpb24gfHwgJ1NvbWV0aGluZyB3ZW50IHdyb25nIScpO1xuICAgICAgICBlcnJvck9iai5zdGF0dXNDb2RlID0ganNvbi5zdGF0dXNfY29kZSB8fCByZXNwb25zZS5zdGF0dXMgfHwgNTAwO1xuICAgICAgICBlcnJvck9iai5lcnJvciA9IGpzb24uZXJyb3IgfHwgJ0Vycm9yJztcbiAgICAgICAgdGhyb3cgZXJyb3JPYmo7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBsZXQgZXJyb3JPYmogPSBuZXcgRXJyb3IoJ1NvbWV0aGluZyB3ZW50IHdyb25nIScpO1xuICAgICAgICBlcnJvck9iai5zdGF0dXNDb2RlID0gcmVzcG9uc2Uuc3RhdHVzIHx8IDUwMDtcbiAgICAgICAgZXJyb3JPYmouZXJyb3IgPSAnRXJyb3InO1xuICAgICAgICB0aHJvdyBlcnJvck9iajtcbiAgICAgIH1cbiAgICB9IGNhdGNoIChleGVjKSB7XG4gICAgICBjb25zb2xlLmxvZygnRVJST1IgPiBHRU5FUkFUSU5HIFBBSVJJTkcgVE9LRU4gPiAnLCBleGVjKTtcbiAgICAgIHRocm93IGV4ZWM7XG4gICAgfVxuICB9XG5cbiAgY29uc3QgZ2V0QWNjZXNzVG9rZW4gPSBhc3luYyAocGFpcmluZ1Rva2VuLCBvcHRpb25zID0ge30pID0+IHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoYXN5bmMgKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgdHJ5IHtcbiAgICAgICAgaWYgKCFwYWlyaW5nVG9rZW4pIHtcbiAgICAgICAgICBsZXQgcmVzcCA9IGF3YWl0IHRoaXMuZ2VuZXJhdGVQYWlyaW5nVG9rZW4ob3B0aW9ucyk7XG4gICAgICAgICAgcGFpcmluZ1Rva2VuID0gcmVzcC50b2tlbjtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGNoZWNrUG9sbGluZ1VybCA9IGFzeW5jICgpID0+IHtcbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgbGV0IHJlc3AgPSBhd2FpdCBwb2xsaW5nVXJsKHBhaXJpbmdUb2tlbiwgb3B0aW9ucyk7XG4gICAgICAgICAgICBpZiAocmVzcC5yZXN1bHQgJiYgcmVzcC5yZXN1bHQgPT0gJ29rJykge1xuICAgICAgICAgICAgICBjbGVhckludGVydmFsKHRoaXMuaW50ZXJ2YWxJbnN0YW5jZSk7XG4gICAgICAgICAgICAgIHJlc29sdmUocmVzcCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBjYXRjaCAoZXhlYykge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignRVJST1IgPiBHRVRUSU5HIEFDQ0VTUyBUT0tFTiA+ICcpO1xuICAgICAgICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLmludGVydmFsSW5zdGFuY2UpO1xuICAgICAgICAgICAgcmVqZWN0KGV4ZWMpO1xuICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICBpZiAoIXN0b3BQb2xsaW5nKSB7XG4gICAgICAgICAgdGhpcy5pbnRlcnZhbEluc3RhbmNlID0gc2V0SW50ZXJ2YWwoY2hlY2tQb2xsaW5nVXJsLCAyICogMTAwMCk7XG4gICAgICAgIH1cbiAgICAgIH0gY2F0Y2ggKGV4ZWMpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ0VSUk9SID4gR0VUVElORyBBQ0NFU1MgVE9LRU4gPiAnLCBleGVjKTtcbiAgICAgICAgcmVqZWN0KGV4ZWMpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgY29uc3QgcG9sbGluZ1VybCA9IGFzeW5jIChwYWlyaW5nVG9rZW4sIG9wdGlvbnMgPSB7fSkgPT4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBBUElfVVJMID0gYCR7d2luZG93LkFQSV9VUkx9L3JwYy9wYWlyaW5nX3Rva2VuP3Q9JHtwYWlyaW5nVG9rZW59YDtcblxuICAgICAgY29uc3QgcmVxT2JqID0ge1xuICAgICAgICBtZXRob2Q6ICdHRVQnLFxuICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgfSxcbiAgICAgIH07XG5cbiAgICAgIGlmIChvcHRpb25zLmhlYWRlcnMpIHtcbiAgICAgICAgcmVxT2JqLmhlYWRlcnMgPSBPYmplY3QuYXNzaWduKHJlcU9iai5oZWFkZXJzLCBvcHRpb25zLmhlYWRlcnMpO1xuICAgICAgfVxuXG4gICAgICBsZXQgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChBUElfVVJMLCByZXFPYmopO1xuICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PSAyMDApIHtcbiAgICAgICAgbGV0IGpzb24gPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gICAgICAgIHJldHVybiBqc29uO1xuICAgICAgfVxuICAgICAgbGV0IGpzb24gPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gICAgICBpZiAoanNvbi5lcnJvcikge1xuICAgICAgICBsZXQgZXJyb3JPYmogPSBuZXcgRXJyb3IoanNvbi5kZXNjcmlwdGlvbiB8fCAnU29tZXRoaW5nIHdlbnQgd3JvbmchJyk7XG4gICAgICAgIGVycm9yT2JqLnN0YXR1c0NvZGUgPSBqc29uLnN0YXR1c19jb2RlIHx8IHJlc3BvbnNlLnN0YXR1cyB8fCA1MDA7XG4gICAgICAgIGlmIChlcnJvck9iai5zdGF0dXNDb2RlID09IDQwNCkge1xuICAgICAgICAgIGVycm9yT2JqLm1lc3NhZ2UgPSAnRmFpbGVkIHRvIHBhaXIuIFBsZWFzZSB0cnkgYWdhaW4hJztcbiAgICAgICAgfVxuICAgICAgICBlcnJvck9iai5lcnJvciA9IGpzb24uZXJyb3IgfHwgJ0Vycm9yJztcbiAgICAgICAgdGhyb3cgZXJyb3JPYmo7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBsZXQgZXJyb3JPYmogPSBuZXcgRXJyb3IoJ1NvbWV0aGluZyB3ZW50IHdyb25nIScpO1xuICAgICAgICBlcnJvck9iai5zdGF0dXNDb2RlID0gcmVzcG9uc2Uuc3RhdHVzIHx8IDUwMDtcbiAgICAgICAgaWYgKGVycm9yT2JqLnN0YXR1c0NvZGUgPT0gNDA0KSB7XG4gICAgICAgICAgZXJyb3JPYmoubWVzc2FnZSA9ICdGYWlsZWQgdG8gcGFpci4gUGxlYXNlIHRyeSBhZ2FpbiEnO1xuICAgICAgICB9XG4gICAgICAgIGVycm9yT2JqLmVycm9yID0gJ0Vycm9yJztcbiAgICAgICAgdGhyb3cgZXJyb3JPYmo7XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXhlYykge1xuICAgICAgY29uc29sZS5sb2coJ0VSUk9SID4gR0VORVJBVElORyBBVVRIIFVSTCA+ICcsIGV4ZWMpO1xuICAgICAgdGhyb3cgZXhlYztcbiAgICB9XG4gIH1cblxuXG5jaHJvbWUudGFicy5vblJlbW92ZWQuYWRkTGlzdGVuZXIoKHRhYklkKSA9PiB7Ly9jaGVjayBpZiB0aGUgdGFiIGRlbGV0ZWRcbiAgY2hlY2tJZlRhYlVwZGF0ZWQxKHRhYklkKVxufSk7XG5cbmNocm9tZS50YWJzLm9uVXBkYXRlZC5hZGRMaXN0ZW5lcigodGFiSWQpID0+IHsvL2NoZWNrIGlmIHRoZSB0YWIgdXBkYXRlZFxuICBjaGVja0lmVGFiVXBkYXRlZDEodGFiSWQpXG59KTtcblxuZnVuY3Rpb24gY2hlY2tJZlRhYlVwZGF0ZWQxKHRhYklkKXsvL2lmIHRoZSB0YWIgZGVsZXRlZCBvciB1cGRhdGVkIHN0b3AgdGhlIHBvbGxpbmdcbiAgbGV0IGZpbmRJZlJlZnJlc2hlZCA9IGNoZWNrVGFic0FyZVVwZGF0ZU9yUmVtb3ZlZC5maW5kKGZpbmRUYWI9PmZpbmRUYWI9PT10YWJJZClcbiAgaWYoZmluZElmUmVmcmVzaGVkKXtcbiAgICBjbGVhckludGVydmFsKHRoaXMuaW50ZXJ2YWxJbnN0YW5jZSlcbiAgfVxufSBcbiIsImxldCBzZW5kRmlyc3RJbnN0YWxsRXZlbnQgPSBmYWxzZVxuY2hyb21lLnJ1bnRpbWUub25NZXNzYWdlLmFkZExpc3RlbmVyKChtZXNzYWdlLCBzZW5kZXIsIHNlbmRSZXNwb25zZSkgPT4ge1xuICAgIGlmKG1lc3NhZ2UuYXBpID09PSAndHJhY2tFdmVudCcpe1xuICAgICAgICBpZihzZW5kZXIgJiYgc2VuZGVyLm9yaWdpbiAmJiB0eXBlb2Ygc2VuZGVyLm9yaWdpbiA9PT0gJ3N0cmluZycgJiYgc2VuZGVyLm9yaWdpbi5pbmNsdWRlcygnLmZpZ21hLicpKXtcbiAgICAgICAgICBsZXQgcGFyYW1zID0gbWVzc2FnZS5wYXJhbXMgPyBtZXNzYWdlLnBhcmFtcyA6IHt9XG4gICAgICAgICAgc2VuZFRyYWNrRXZlbnQobWVzc2FnZS5ldmVudE5hbWUsIG1lc3NhZ2UudXNlcklkLCBtZXNzYWdlLnVzZXJFbWFpbCwgcGFyYW1zKVxuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2UgaWYobWVzc2FnZS5hcGkgPT09ICdmaXJzdFJlZnJlc2gnKXtcbiAgICAgIFVVSUQgPSBtZXNzYWdlLlVVSURcblxuICAgICAgaWYoc2VuZEZpcnN0SW5zdGFsbEV2ZW50KXtcbiAgICAgICAgc2VuZEZpcnN0SW5zdGFsbEV2ZW50ID0gZmFsc2VcbiAgICAgICAgc2V0VGltZW91dCgoKT0+e1xuICAgICAgICAgIHNlbmRUcmFja0V2ZW50KCdjaHJvbWUuZXh0ZW5zaW9uLmluc3RhbGxlZCcsICcnLCAnJylcbiAgICAgICAgfSw1MDAwKVxuICAgICAgfVxuICAgIH0gICAgXG4gICAgZWxzZSBpZihtZXNzYWdlLmFwaSA9PT0gJ2FsaWFzJyl7XG4gICAgICAgIGFsaWFzKG1lc3NhZ2UudXNlcklkLCBtZXNzYWdlLmVtYWlsKVxuICAgIH1cbiAgICByZXR1cm4gdHJ1ZVxufSk7XG5cbmxldCB0cmFja2luZ0NsYXNzXG5mdW5jdGlvbiBzZW5kVHJhY2tFdmVudChldmVudE5hbWUsIHVzZXJJZCwgdXNlckVtYWlsLCBwYXJhbXMgPSB7fSl7XG4gICAgdXNlcklkID0gVVVJRC8vdXNlcklkID8gdXNlcklkIDogVVVJRFxuICAgIFxuICAgIHZhciBhcmdzID0ge1xuICAgICAgICBldmVudENhdGVnb3J5OiAnR2VuZXJhbCcsXG4gICAgICAgIGV2ZW50QWN0aW9uOiBldmVudE5hbWUgPyBldmVudE5hbWUgOiAnJyxcbiAgICAgICAgdWlkOiB1c2VySWQsXG4gICAgfTtcbiAgICBcbiAgICBwYXJhbXMuZXh0ZW5zaW9uTmFtZSA9IHdpbmRvdy5leHRlbnNpb25OYW1lXG4gICAgYXJnc1sncGFyYW1zJ10gPSBKU09OLnN0cmluZ2lmeShwYXJhbXMpO1xuICAgIFxuICAgIHZhciBkYXRhID0gcGFyYW1ldGl6ZShhcmdzKTtcbiAgICB2YXIgaHR0cCA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xuICAgIHZhciB1cmwgPSAnaHR0cHM6Ly9sb2dzLmFuaW1hYXBwLmNvbS9hbmFseXRpY3MvY29sbGVjdCc7XG4gICAgaHR0cC5vcGVuKCdQT1NUJywgdXJsLCB0cnVlKTtcblxuICAgIGh0dHAuc2V0UmVxdWVzdEhlYWRlcignQ29udGVudC10eXBlJywgJ2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCcpO1xuICAgIC8vIGh0dHAuc2V0UmVxdWVzdEhlYWRlcignWC1Vc2VyLUlkJywgdXNlcklkID8gdXNlcklkIDogJycpO1xuICAgIGh0dHAuc2V0UmVxdWVzdEhlYWRlcignWC1Vc2VyLUVtYWlsJywgdXNlckVtYWlsID8gdXNlckVtYWlsIDogJycpO1xuICAgIGh0dHAuc2V0UmVxdWVzdEhlYWRlcignWC1DbGllbnQtSWQnLCAnY29tLmFuaW1hYXBwLmNocm9tZS5leHRlbnNpb24nKTtcbiAgICAvLyBodHRwLnNldFJlcXVlc3RIZWFkZXIoJ1gtQ2xpZW50LUlkJywgJ2NvbS5hbmltYWFwcC5maWdtYScpO1xuICAgIGh0dHAuc2V0UmVxdWVzdEhlYWRlcignWC1DbGllbnQtVmVyc2lvbicsICcxLjAuMCcpO1xuICAgIGh0dHAuc2VuZChkYXRhKTtcbiAgICBcbiAgICBmdW5jdGlvbiBwYXJhbWV0aXplKG9iamVjdCkge1xuICAgICAgdmFyIGVuY29kZWRTdHJpbmcgPSAnJztcbiAgICAgIGZvciAodmFyIHByb3AgaW4gb2JqZWN0KSB7XG4gICAgICAgIGlmIChvYmplY3QuaGFzT3duUHJvcGVydHkocHJvcCkpIHtcbiAgICAgICAgICBpZiAoZW5jb2RlZFN0cmluZy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBlbmNvZGVkU3RyaW5nICs9ICcmJztcbiAgICAgICAgICB9XG4gICAgICAgICAgZW5jb2RlZFN0cmluZyArPSBlbmNvZGVVUkkocHJvcCArICc9JyArIG9iamVjdFtwcm9wXSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiBlbmNvZGVkU3RyaW5nO1xuICAgIH1cbn1cblxuXG5sZXQgVVVJRCA9IG51bGxcbi8vIGZ1bmN0aW9uIGNyZWF0ZVVVSUQoKXtcbi8vICAgICB3aW5kb3cuY2hyb21lLnN0b3JhZ2Uuc3luYy5nZXQoJ3VzZXJVVUlEJywoZGF0YSk9Pntcbi8vICAgICAgICAgaWYoZGF0YSAmJiBkYXRhLnVzZXJVVUlEICYmIGRhdGEudXNlclVVSUQuaWQpe1xuLy8gICAgICAgICAgICAgVVVJRCA9IGRhdGEudXNlclVVSUQuaWRcbi8vICAgICAgICAgfVxuLy8gICAgICAgICBlbHNle1xuLy8gICAgICAgICAgICAgVVVJRCA9IGdlbmVyYXRlTmV3VVVJRCgpXG4vLyAgICAgICAgICAgICB3aW5kb3cuY2hyb21lLnN0b3JhZ2Uuc3luYy5zZXQoe3VzZXJVVUlEOntpZDpVVUlEfX0pXG4vLyAgICAgICAgICAgICBpZihzZW5kRmlyc3RJbnN0YWxsRXZlbnQpe1xuLy8gICAgICAgICAgICAgICBzZW5kRmlyc3RJbnN0YWxsRXZlbnQgPSBmYWxzZVxuLy8gICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpPT57XG4vLyAgICAgICAgICAgICAgICAgc2VuZFRyYWNrRXZlbnQoJ2Nocm9tZS5leHRlbnNpb24uaW5zdGFsbGVkJywgJycsICcnKVxuLy8gICAgICAgICAgICAgICB9LDUwMDApXG4vLyAgICAgICAgICAgICB9XG4vLyAgICAgICAgIH1cbi8vICAgICB9KVxuLy8gfVxuXG5jaHJvbWUucnVudGltZS5vbkluc3RhbGxlZC5hZGRMaXN0ZW5lcihmdW5jdGlvbihkZXRhaWxzKXtcbiAgaWYoZGV0YWlscy5yZWFzb24gPT0gXCJpbnN0YWxsXCIpe1xuICAgIHNlbmRGaXJzdEluc3RhbGxFdmVudCA9IHRydWVcbiAgfVxufSk7XG5cbmZ1bmN0aW9uIGdlbmVyYXRlTmV3VVVJRCgpIHtcbiAgICB2YXIgZCA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpO1xuICAgIGlmIChcbiAgICAgIHR5cGVvZiBwZXJmb3JtYW5jZSAhPT0gXCJ1bmRlZmluZWRcIiAmJlxuICAgICAgdHlwZW9mIHBlcmZvcm1hbmNlLm5vdyA9PT0gXCJmdW5jdGlvblwiXG4gICAgKSB7XG4gICAgICBkICs9IHBlcmZvcm1hbmNlLm5vdygpOyAvL3VzZSBoaWdoLXByZWNpc2lvbiB0aW1lciBpZiBhdmFpbGFibGVcbiAgICB9XG4gICAgcmV0dXJuIFwieHh4eHh4eHgteHh4eC00eHh4LXl4eHgteHh4eHh4eHh4eHh4XCIucmVwbGFjZShcbiAgICAgIC9beHldL2csXG4gICAgICBmdW5jdGlvbihjKSB7XG4gICAgICAgIHZhciByID0gKGQgKyBNYXRoLnJhbmRvbSgpICogMTYpICUgMTYgfCAwO1xuICAgICAgICBkID0gTWF0aC5mbG9vcihkIC8gMTYpO1xuICAgICAgICByZXR1cm4gKGMgPT09IFwieFwiID8gciA6IChyICYgMHgzKSB8IDB4OCkudG9TdHJpbmcoMTYpO1xuICAgICAgfVxuICAgICk7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIGFsaWFzKHVzZXJJZCwgdXNlckVtYWlsKSB7XG4gICAgaWYgKFVVSUQgJiYgdXNlcklkKSB7XG4gICAgICBjb25zdCBhcmdzID0ge1xuICAgICAgICBhbGlhczogdXNlcklkLC8vdGhlIHVzZXIgaWQgZnJvbSBkYlxuICAgICAgICBkaXN0aW5jdF9pZDpVVUlELCAvL3RoZSBvbGQgdXNlciBpZFxuICAgICAgfTtcbiAgICAgIFxuICAgICAgdHJ5IHtcbiAgICAgICAgbGV0IHVybCA9IGBodHRwczovL2xvZ3MuYW5pbWFhcHAuY29tL2FuYWx5dGljcy9yZWdpc3Rlcl9hbGlhc2A7XG4gICAgICAgIGxldCByZXMgPSBhd2FpdCBzZW5kUmVxdWVzdCh1cmwsIGFyZ3MsIHVzZXJJZCwgdXNlckVtYWlsKTtcbiAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ3JlZ2lzdGVyX2FsaWFzIGZhaWxlZCcsIGUpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIHNlbmRSZXF1ZXN0KHVybCwgYXJncywgdXNlcklkLCB1c2VyRW1haWwpIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlamVjdCwgcmVzb2x2ZSkgPT4ge1xuICAgICAgY29uc3QgZGF0YSA9IHBhcmFtZXRlcml6ZShhcmdzKTtcblxuICAgICAgY29uc3QgaHR0cCA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xuICAgICAgXG4gICAgICBodHRwLm9wZW4oJ1BPU1QnLCB1cmwsIHRydWUpO1xuICAgICAgaHR0cC5zZXRSZXF1ZXN0SGVhZGVyKCdDb250ZW50LXR5cGUnLCAnYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkJyk7XG4gICAgICBodHRwLnNldFJlcXVlc3RIZWFkZXIoJ1gtVXNlci1JZCcsIHVzZXJJZCA/IHVzZXJJZCA6ICcnKTtcbiAgICAgIGh0dHAuc2V0UmVxdWVzdEhlYWRlcignWC1Vc2VyLUVtYWlsJywgdXNlckVtYWlsID8gdXNlckVtYWlsIDogJycpO1xuICAgICAgaHR0cC5zZXRSZXF1ZXN0SGVhZGVyKCdYLUNsaWVudC1JZCcsICdjb20uYW5pbWFhcHAuY2hyb21lLmV4dGVuc2lvbicpO1xuICAgICAgaHR0cC5zZXRSZXF1ZXN0SGVhZGVyKCdYLUNsaWVudC1WZXJzaW9uJywgJzEuMC4wJyk7XG5cblxuICAgICAgZm9yIChjb25zdCBoIGluIHRoaXMuaGVhZGVycykge1xuICAgICAgICBjb25zdCB2ID0gdGhpcy5oZWFkZXJzW2hdO1xuICAgICAgICBodHRwLnNldFJlcXVlc3RIZWFkZXIoaCwgdik7XG4gICAgICB9XG5cbiAgICAgIGh0dHAub25yZWFkeXN0YXRlY2hhbmdlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoaHR0cC5yZWFkeVN0YXRlID09PSA0ICYmIGh0dHAuc3RhdHVzID09PSAyMDApIHtcbiAgICAgICAgICByZXNvbHZlKGh0dHAucmVzcG9uc2UpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJlamVjdCh7XG4gICAgICAgICAgICBzdGF0dXM6IGh0dHAuc3RhdHVzLFxuICAgICAgICAgICAgc3RhdHVzVGV4dDogaHR0cC5zdGF0dXNUZXh0LFxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9O1xuXG4gICAgICBodHRwLm9uZXJyb3IgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJlamVjdCh7XG4gICAgICAgICAgc3RhdHVzOiBodHRwLnN0YXR1cyxcbiAgICAgICAgICBzdGF0dXNUZXh0OiBodHRwLnN0YXR1c1RleHQsXG4gICAgICAgIH0pO1xuICAgICAgfTtcblxuICAgICAgaHR0cC5zZW5kKGRhdGEpO1xuICAgIH0pO1xuICB9XG5cbiAgY29uc3QgcGFyYW1ldGVyaXplID0gKG9iaikgPT4ge1xuICAgIGxldCBlbmNvZGVkU3RyaW5nID0gJyc7XG4gICAgZm9yIChsZXQgcHJvcCBpbiBvYmopIHtcbiAgICAgIGlmIChvYmouaGFzT3duUHJvcGVydHkocHJvcCkpIHtcbiAgICAgICAgaWYgKGVuY29kZWRTdHJpbmcubGVuZ3RoID4gMCkge1xuICAgICAgICAgIGVuY29kZWRTdHJpbmcgKz0gJyYnO1xuICAgICAgICB9XG4gICAgICAgIGVuY29kZWRTdHJpbmcgKz0gZW5jb2RlVVJJKHByb3AgKyAnPScgKyBvYmpbcHJvcF0pO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gZW5jb2RlZFN0cmluZztcbiAgfTsiXSwic291cmNlUm9vdCI6IiJ9